Crasm 1.8:                           MONDEB                  page  1

                         1          NAM   MONDEB
                         2          CPU   6800
                         3  ;THIS SOURCE CODE WAS SENT TO WALTER BANKS AT
                         4  ;THE UNIVERSITY OF WATERLOO BY DON PETERS ON PAP
 ER TAPE
                         5  ;CROSS ASSEMBLY WAS DONE ON THE U OF W HONEYWELL
 66/60
                         6  ;THE BARCODE AND LISTING WERE SET ON A PHOTON PH
 OTO-
                         7  ;TYPESETTER DRIVEN BY THE HONEYWELL.
                         8  ;
                         9  ;       M O N D E B  - A MONITOR/DEBUGGER FOR TH
        E M6800 MICROPROCESSOR
                        10  
                        11  ; AUTHOR: DON PETERS
                        12  ; DATE: APRIL 1977
                        13  ; MEMORY REQ'D: 3K BYTES AT HIGH END OF ADDRESS 
  SPACE
                        14  
                        15  ; SEE USER MANUAL FOR CAPABILITIES & INSTRUCTION
  S ON USE
                        16  
                        17  ;      * =     $400    ;DEBUG ORG AT 1K
  F400                  18         * =    $F400    ;NORMAL ORIGIN AT 61K
                        19  
                        20  
                        21  
                        22  ;I/O DEVICE ADDRESSES
  7F43                  23  ACIA1  EQU    $7F43    ;ACIA #1 - MAIN TERMINAL 
                        ACIA
  7F45                  24  ACIA2  EQU    $7F45    ;ACIA #2 - AUXILIARY TERM
                        INAL ACIA
                        25  
                        26  ;OTHER CONSTANTS
  000D                  27  CR     EQU    13       ;CARRIAGE RETURN
  000A                  28  LF     EQU    10       ;LINE FEED
                        29  
                        30  
                        31  
  F400                  32  START  EQU    *        ;PROGRAM ENTRY POINT
F400 8E70B1             33         LDS    #STACK   ;INITIALIZE THE STACK POI
                        NTER
F403 BF7006             34         STS    SP       ;SAVE THE POINTER
F406 BDFE08             35         JSR    INITAL   ;INITIALIZE VARIABLES
                        36  
                        37  
                        38  ;TYPE OUT MONITOR NAME & VERSION
F409 BDFEC7             39         JSR    DOCRLF   ;ADVANCE TO A CLEAN LINE
F40C CEFEF2             40         LDX    #MSGHED  ;GET ADDRESS OF HEADER
F40F BDFE4B             41         JSR    OUTSTR   ;TYPE IT
                        42  
                        43  ;SET UP DESTINATION OF INPUT LINE
                        44  ;DEFINE BEGINNING OF INPUT BUFFER
F412 CE702F             45         LDX    #TTYBUF-1   ;GET ADDRESS OF TERMIN
                           AL INPUT BUFFER
F415 FF702C             46         STX    BUFBEG   ;SAVE IT
                        47  
                        48  ;DEFINE END OF INPUT BUFFER - 72 CHAR CAPACITY, 
 INCL CR
F418 CE7078             49         LDX    #TTYEND
F41B FF702E             50         STX    BUFEND
                        51  


Crasm 1.8:                           MONDEB                  page  2

                        52  ;DELIMITER CLASS DEFINITION - SPACE OR COMMA (CO
 DE 3)
F41E 8603               53         LDAA   #3
F420 B7700F             54         STAA   DELIM
F423 200F               55         BRA    PROMP1
                        56  
                        57  ;PREPARE TO GET A NEW COMMAND
F425 BDFEC7             58  PROMPT JSR    DOCRLF   ;TYPE CR-LF
F428 7C700E             59         INC    BOLFLG   ;SET "BEGINNING OF LINE" 
                        FLAG
F42B FE700A             60         LDX    SYNPTR   ;POINT TO CURRENT CHARACT
                        ER
F42E A600               61         LDAA   ,X       ;GET IT
F430 813B               62         CMPA   #';'     ;SEMICOLON?
F432 271A               63         BEQ    GETCMD   ;CONTINUE SCAN IF IT IS, 
                        SKIPPING THE PROMPT
                        64  
                        65  ;TYPE PROMPT
F434 CEFEFF             66  PROMP1 LDX    #MSGPRM
F437 BDFE4B             67         JSR    OUTSTR
                        68  
F43A BDFD8C             69         JSR    GETLIN  ;GET LINE OF INPUT
                        70  
                        71  ;ABORT LINE ON A CONTROL-C
F43D C103               72         CMPB   #3
F43F 27E4               73         BEQ    PROMPT
                        74  
                        75  ;SET SYNTAX SCANNING POINTER TO BEGINNING OF BUF
 FER/LINE
F441 FE702C             76         LDX    BUFBEG
F444 FF700A             77         STX    SYNPTR
                        78  
                        79  ;REPROMPT ON AN EMPTY LINE (FIRST CHAR = CR, LF,
 OR ;)
F447 A601               80         LDAA   1,X      ;GET FIRST CHAR
F449 BDFA89             81         JSR    TSTEOL   ;TEST IT
F44C 27D7               82         BEQ    PROMPT   ;IF IT IS, PROMPT AGAIN
                        83  
                        84  ;USE LIST 1 WHEN MATCHING
F44E 8601               85  GETCMD LDAA   #1
                        86  
                        87  ;NOW GO FOR A MATCH
F450 BDF9C7             88         JSR    COMAND
                        89  
                        90  ;-AND TEST THE RESULT OF THE SCAN
F453 27D0               91         BEQ    PROMPT   ;REPROMPT IF JUST A CR WA
                        S TYPED
F455 2E1F               92         BGT    JMPCMD   ;GOOD COMMAND IF POSITIVE
                        93  
                        94  ;*****
                        95  ;UNRECOGNIZABLE SYNTAX - POINT TO ERROR
F457 FE702C             96  BADSYN LDX    BUFBEG   ;GET START OF LINE
                        97  ;SPACE OVER TO ERROR IN SYNTAX
F45A BC700C             98  BADS1  CPX    LINPTR   ;AT ERROR?
                        99  
F45D 2706              100         BEQ    BADS2
F45F BDFBF1            101         JSR    OUTSP    ;OUTPUT A SPACE
F462 08                102         INX             ;NO, MOVE ON
F463 20F5              103         BRA    BADS1
                       104  
                       105  ;THE "EXTRA" CHAR "1" IS COMPENSATED FOR BY THE 
 PROMPT CHAR ON THE PRECEDING LINE


Crasm 1.8:                           MONDEB                  page  3

F465 865E              106  BADS2  LDAA   #'^'     ;AT ERROR - GET AN UP-ARR
                        OW
F467 BDFE76            107         JSR    OUTCHR   ;PRINT IT
F46A BDFEC7            108         JSR    DOCRLF
F46D 20C5              109         BRA    PROMP1   ;IGNORE ANY SUCCEEDING PA
                        CKED
                       110  ;                        COMMANDS
                       111  
                       112  ;*****
                       113  ;THERE SHOULD BE NO MORE CHARACTERS ON THE INPUT
 LINE
                       114  ;                       (EXCEPT DELIMITERS)
F46F BDFA69            115  NOMORE JSR    SKPDLM
F472 25B1              116         BCS    PROMPT   ;IF CARRY BIT SET, END OF
                        LINE (NORMAL)
                       117  ;THERE IS SOMETHING THERE BUT SHOULDN'T BE
F474 20E1              118         BRA    BADSYN
                       119  
                       120  ;*****
                       121  ;EXECUTE A COMPUTED "GOTO" TO THE PROPER COMMAND
F476 16                122  JMPCMD TAB             ;SAVE COMMAND # IN ACCB
F477 48                123         ASLA            ;MULTIPLY COMMAND BY 2
F478 1B                124         ABA             ;ACCA NOW HOLDS COMMAND #
                        MULTIPLIED BY 3
                       125  ;ADD IT TO BASE OF JUMP TABLE
F479 C6F4              126         LDAB   #JMPHI   ;GET HI BYTE OF START OF 
                        JUMP TABLE IN ACCB
F47B 8B85              127         ADDA   #JMPLO   ;ADD LO BYTE OF START OF 
                        JUMP TABLE TO ACCA
F47D C900              128         ADCB   #0       ;ADD CARRY IF THERE WAS O
                        NE
                       129  ;MOVE ACCA & ACCB TO IX (CODE IS WEIRD, BUT BRIE
 F)
F47F 36                130         PSHA
F480 37                131         PSHB
F481 30                132         TSX             ;PUT ADDRESS OF "GOTO" IN
                        TO X
F482 EE00              133         LDX    ,X       ;GET THE ADDRESS ITSELF
F484 33                134         PULB            ;RESTORE THE STACK
F485 32                135         PULA
                       136  
F486 6E00              137         JMP    ,X       ;JUMP TO RIGHT COMMAND
                       138  
  F485                 139  JMPTBL EQU    *-3
                       140  
  00F4                 141  JMPHI  EQU    JMPTBL/256
  F400                 142  JMP256 EQU    JMPHI*256
  0085                 143  JMPLO  EQU    JMPTBL-JMP256
                       144  
F488 7EF4C7            145         JMP    REG
F48B 7EF514            146         JMP    GOTO
F48E 7EF526            147         JMP    LSEI
F491 7EF529            148         JMP    LCLI
F494 7EF52C            149         JMP    COPY
F497 7EF558            150         JMP    BREAK
F49A 7EF5B8            151         JMP    IBASE
F49D 7EF5CE            152         JMP    DBASE
F4A0 7EF604            153         JMP    CONTIN
F4A3 7EF608            154         JMP    DISPLA
F4A6 7EF673            155         JMP    SET
F4A9 7EF720            156         JMP    VERIFY
F4AC 7EF766            157         JMP    SEARCH


Crasm 1.8:                           MONDEB                  page  4

F4AF 7EF7ED            158         JMP    TEST
F4B2 7EF844            159         JMP    INT
F4B5 7EF84C            160         JMP    NMI
F4B8 7EF854            161         JMP    LSWI
F4BB 7EF85C            162         JMP    COMPAR
F4BE 7EF885            163         JMP    DUMP
F4C1 7EF924            164         JMP    LOAD
F4C4 7EF9B5            165         JMP    DELAY
                       166  ;*****
                       167  ;REG - DISPLAY REGISTERS
  F4C7                 168  REG    EQU    *
                       169  ;PRINT STACK STORED SWI DATA
F4C7 FE7006            170  DISREG LDX    SP       ;GET SAVED STACK POINTER
F4CA 08                171         INX
                       172  ;REGISTER NAME TYPEOUT INITIALIZATION
F4CB 7F70D6            173         CLR    COMNUM   ;START AT BEGINNING OF TH
                        E REGISTER NAME LIST
                       174  
F4CE 8D13              175         BSR    OUT2     ;TYPE CONDITION CODES
F4D0 8D11              176         BSR    OUT2     ;TYPE ACCB
F4D2 8D0F              177         BSR    OUT2     ;TYPE ACCA
                       178  
F4D4 8D14              179         BSR    OUT4     ;TYPE INDEX REG
F4D6 8D12              180         BSR    OUT4     ;TYPE PROGRAM COUNTER
                       181  
                       182  ;TYPE THE STACK POINTER LOCATION
F4D8 8D18              183         BSR    OUT2A4   ;TYPE STACK POINTER ID
F4DA CE7006            184         LDX    #SP
F4DD BDFC04            185         JSR    OUT2BY   ;TYPE THE VALUE
                       186  
F4E0 7EF46F            187         JMP    NOMORE
                       188  
                       189  ;OUTPUT CONTENT OF A 1 BYTE REGISTER
F4E3 8D0D              190  OUT2   BSR    OUT2A4
F4E5 BDFBFD            191         JSR    OUT1BY
F4E8 08                192         INX
F4E9 39                193         RTS
                       194  
                       195  ;OUTPUT CONTENT OF A 2 BYTE RESISTER
F4EA 8D06              196  OUT4   BSR    OUT2A4
F4EC BDFC04            197         JSR    OUT2BY
F4EF 08                198         INX             ;SKIP TO NEXT BYTE IN STA
                        CK
F4F0 08                199         INX             ;SKIP TO NEXT BYTE IN STA
                        CK
F4F1 39                200         RTS
                       201  
                       202  ;MISC SETUP FOR REGISTER DISPLAY
F4F2 BDFBF1            203  OUT2A4 JSR    OUTSP    ;OUTPUT A SPACE
F4F5 7C70D6            204         INC    COMNUM   ;SKIP TO NEXT REGISTER NA
                        ME
F4F8 8605              205         LDAA   #5       ;REGISTER NAME IS IN LIST
                        5
F4FA BDFA2E            206         JSR    TYPCMD   ;TYPE IT
F4FD BDFBF7            207         JSR    OUTEQ    ;TYPE AN "="
F500 39                208         RTS
                       209  
                       210  ;ENTER HERE FROM SOFTWARE INTERRUPT
F501 CEFF01            211  TYPSWI LDX    #MSGSWI
F504 BDFE4B            212         JSR    OUTSTR
                       213  ;DECREMENT PC SO IT POINTS TO "SWI" INSTRUCTION
F507 FE7006            214         LDX    SP


Crasm 1.8:                           MONDEB                  page  5

F50A 6D07              215         TST    7,X      ;TEST LO BYTE OF PC FOR P
                        ENDING BORROW
F50C 2602              216         BNE    TYPSW1
F50E 6A06              217         DEC    6,X      ;NEED TO BORROW, DEC HI B
                        YTE OF PC
F510 6A07              218  TYPSW1 DEC    7,X      ;DECR LO BYTE OF PC
F512 20B3              219         BRA    DISREG   ;GO DISPLAY REGISTERS
                       220  ;*****
                       221  ;GOTO - GO TO MEMORY ADDRESS
F514 BDFB47            222  GOTO   JSR    NUMBER   ;GET DESTINATION
F517 2708              223         BEQ    GOTO1    ;IF NONE, USE DEFAULT
F519 FE7013            224         LDX    NBRHI
F51C FF7019            225         STX    LASTGO   ;SAVE IT
F51F 6E00              226         JMP    ,X       ;GO TO DESTINATION
                       227  
F521 FE7019            228  GOTO1  LDX   LASTGO    ;GET LAST GOTO ADDRESS
F524 6E00              229         JMP   ,X        ;GO TO IT
                       230  ;*****
                       231  ;SEI - SET INTERRUPT MASK
F526 0F                232  LSEI   SEI
F527 202C              233         BRA    COPY3
                       234  
                       235  ;*****
                       236  ;CLI - CLEAR INTERRUPT MASK
F529 0E                237  LCLI   CLI
F52A 2029              238         BRA    COPY3
                       239  
                       240  ;*****
                       241  ;COPY - COPY FROM ONE LOCATION TO ANOTHER
F52C BDFAFC            242  COPY   JSR    GTRANG   ;GET SOURCE RANGE INTO RA
                        NGLO & RANGHI
F52F 2F21              243         BLE    COPY2    ;ERROR IF NO SOURCE
F531 BDFB47            244         JSR    NUMBER   ;GET DESTINATION
F534 2F1C              245         BLE    COPY2    ;ERROR IF NO DESTINATION
                       246  
F536 FE7015            247         LDX    RANGLO   ;GET SOURCE ADDRESS POINT
                        ER
F539 A600              248  COPY1  LDAA   ,X       ;GET BYTE FROM SOURCE
F53B FE7013            249         LDX    NBRHI    ;GET DESTINATION ADDRESS 
                        POINTER
F53E A700              250         STAA   ,X       ;SAVE BYTE IN DESTINATION
F540 08                251         INX             ;INC DESTINATION POINTER
F541 FF7013            252         STX    NBRHI    ;SAVE IT
F544 FE7015            253         LDX    RANGLO   ;GET SOURCE ADDRESS POINT
                        ER
F547 BC7017            254         CPX    RANGHI   ;COMPARE TO END OF INPUT 
                        RANGE
F54A 2709              255         BEQ    COPY3    ;DONE IF EQUAL
F54C 08                256         INX             ;NOT EQUAL, INC SOURCE PO
                        INTER
F54D FF7015            257         STX    RANGLO   ;SAVE IT
F550 20E7              258         BRA    COPY1    ;LOOP FOR NEXT BYTE
                       259  
F552 7EF457            260  COPY2  JMP    BADSYN   ;BAD SYNTAX
F555 7EF46F            261  COPY3  JMP    NOMORE   ;SHOULD BE NO MORE ON THE
                        INPUT LINE
                       262  
                       263  ;*****
                       264  ;BREAK - SET BREAKPOINT AT SPECIFIED ADDRESS & R
 EMOVE OLD ONE
F558 BDFB47            265  BREAK  JSR    NUMBER   ;GET BREAKPOINT LOCATION
F55B 2B31              266         BMI    BREAK3   ;IF NOT NUMERIC, LOOK FOR


Crasm 1.8:                           MONDEB                  page  6

                        "?"
F55D 271F              267         BEQ    BREAK2   ;IF NO MODIFIER, REMOVE O
                        LD BREAKPOINT
                       268  
                       269  ;*****
                       270  ;CHECK IF A "SWI" IS STORED AT THE BREAK ADDRESS
F55F FE7020            271         LDX    BRKADR   ;GET CURRENT BREAK ADDRES
                        S
F562 A600              272         LDAA   ,X       ;AND THE CHAR THERE
F564 813F              273         CMPA   #$3F     ;COMPARE TO "SWI"
F566 2605              274         BNE    BREAK1   ;EQUAL?
                       275  ;YES, RESTORE THE OLD INSTRUCTION
F568 B67022            276         LDAA   BRKINS   ;GET IT
F56B A700              277         STAA   ,X       ;RESTORE IT
                       278  
                       279  ;PUT BREAK AT NEWLY SPECIFIED LOCATION
F56D FE7013            280  BREAK1 LDX    NBRHI    ;GET NEW BREAKPOINT (BREA
                        K ADDRESS)
F570 FF7020            281         STX    BRKADR   ;SAVE IT
F573 A600              282         LDAA   ,X       ;GET INSTRUCTION STORED T
                        HERE
F575 B77022            283         STAA   BRKINS   ;SAVE IT
F578 863F              284         LDAA   #$3F     ;GET CODE FOR SOFTWARE IN
                        TERRUPT
F57A A700              285         STAA   ,X       ;PUT IT AT BREAKPOINT
F57C 2034              286         BRA    BREAK5   ;ALL DONE
                       287  
                       288  ;REMOVE BREAKPOINT
F57E FE7020            289  BREAK2 LDX    BRKADR   ;GET ADDRESS OF BREAK
F581 A600              290         LDAA   ,X       ;GET INST. THERE
F583 813F              291         CMPA   #$3F     ;SWI?
F585 262B              292         BNE    BREAK5   ;IF NOT,, RETURN & PROMPT
F587 B67022            293         LDAA   BRKINS   ;WAS A SWI - GET PREVIOUS
                        INST.
F58A A700              294         STAA   ,X       ;& RESTORE IT
F58C 2024              295         BRA    BREAK5
                       296  
                       297  ;LOOK FOR A QUESTION MARK IN LIST 4
F58E 8604              298  BREAK3 LDAA   #4
F590 BDF9C7            299         JSR    COMAND   ;SCAN FOR IT
F593 2F20              300         BLE    BREAK6   ;BAD SYNTAX IF NOT "?"
F595 FE7020            301         LDX    BRKADR   ;IT IS, GET BREAK ADDRESS
F598 A600              302         LDAA   ,X       ;GET INSTRUCTION THERE
F59A 813F              303         CMPA   #$3F     ;IS IT A "SWI"?
F59C 2708              304         BEQ    BREAK4   ;IF YES, SAY SO
                       305  ;NO BREAKPOINT SET
F59E CEFF10            306         LDX    #MSGNBR  ;GET THAT MESSAGE
F5A1 BDFE4B            307         JSR    OUTSTR   ;SAY IT
F5A4 200C              308         BRA    BREAK5
                       309  ;BREAKPOINT SET
F5A6 CEFF18            310  BREAK4 LDX    #MSGBAT  ;GET THAT MESSAGE
F5A9 BDFE4B            311         JSR    OUTSTR   ;SAY IT
F5AC CE7020            312         LDX    #BRKADR  ;GET BREAK ADDRESS
F5AF BDFC04            313         JSR    OUT2BY   ;TYPE IT
                       314  
F5B2 7EF46F            315  BREAK5 JMP    NOMORE
F5B5 7EF457            316  BREAK6 JMP    BADSYN
                       317  
                       318  ;*****
                       319  ;IBASE - SET INPUT BASE
                       320  ;LOOK FOR HEX, DEC, OR OCT IN LIST #3
F5B8 8603              321  IBASE  LDAA   #3


Crasm 1.8:                           MONDEB                  page  7

F5BA BDF9C7            322         JSR    COMAND
F5BD 2B09              323         BMI    IBASE2   ;UNRECOGNIZABLE BASE, TRY
                        "?"
F5BF 2E02              324         BGT    IBASE1
F5C1 8601              325         LDAA   #1       ;NO BASE GIVEN - DEFAULT 
                        TO HEX
F5C3 B77010            326  IBASE1 STAA   IBCODE   ;SAVE BASE CODE
F5C6 20EA              327         BRA    BREAK5
                       328  
                       329  ;LOOK FOR "?" IN LIST #4
F5C8 B67010            330  IBASE2 LDAA   IBCODE   ;GET IB CODE IN CASE ITS 
                        NEEDED
F5CB 36                331         PSHA            ;SAVE IT ON STACK TEMPORA
                        RILY
F5CC 2024              332         BRA    DBASE4
                       333  
                       334  ;*****
                       335  ;DBASE - SET DISPLAY BASE
                       336  ;LOOK FOR HEX,DEC,OCT OR BIN IN LIST #3
F5CE 8603              337  DBASE  LDAA   #3
F5D0 BDF9C7            338         JSR    COMAND
F5D3 2B19              339         BMI    DBASE3   ;UNRECOGNIZABLE BASE, TRY
                        "?"
F5D5 2E02              340         BGT    DBASE1
F5D7 8601              341         LDAA   #1       ;NO BASE GIVEN - DEFAULT 
                        TO HEX
F5D9 B77011            342  DBASE1 STAA   DBCODE
                       343  
                       344  ;COMPUTE THE NUMERIC DISPLAY BASE (FOR THE "DISP
 LAY" COMMAND)
F5DC CEF5E9            345         LDX    #DBTBL-1 ;POINT TO HEAD OF DISPLAY
                        BASE TABLE
F5DF 08                346  DBASE2 INX             ;INC TABLE POINTER
F5E0 4A                347         DECA            ;DECR DISPLAY BASE CODE
F5E1 26FC              348         BNE    DBASE2   ;LOOP IF NOT EQUAL
F5E3 A600              349         LDAA   ,X       ;EQUAL - GET NUMERIC BASE
                        FROM TABLE
F5E5 B77012            350         STAA   DBNBR    ;SAVE IT
F5E8 20C8              351         BRA    BREAK5   ;DONE
                       352  
                       353  ;DISPLAY BASE TABLE
F5EA 10                354  DBTBL  DB     16
F5EB 0A                355         DB     10
F5EC 08                356         DB     8
F5ED 02                357         DB     2
                       358  
                       359  ;LOOK FOR "?" IN LIST #4
F5EE B67011            360  DBASE3 LDAA   DBCODE   ;GET DB CODE IN CASE ITS 
                        NEEDED
F5F1 36                361         PSHA            ;SAVE IT ON STACK TEMPORA
                        RILY
F5F2 8604              362  DBASE4 LDAA   #4
F5F4 BDF9C7            363         JSR    COMAND
F5F7 33                364         PULB            ;RETRIEVE INPUT BASE/DISP
                        LAY BASE CODE
F5F8 2FBB              365         BLE    BREAK6   ;ERROR IF THE "SOMETHING"
                        WAS NOT AN "?"
                       366  ;SET UP FOR TYPEOUT OF BASE CODE
F5FA 8603              367         LDAA   #3       ;ITS IN LIST
F5FC F770D6            368         STAB   COMNUM   ;STORE BASE CODE
F5FF BDFA2E            369         JSR    TYPCMD   ;TYPE OUT BASE
F602 20AE              370         BRA    BREAK5


Crasm 1.8:                           MONDEB                  page  8

                       371  ;*****
                       372  ;CONTINUE - CONTINUE FROM A "SWI"
                       373  ;RETURN TO LOCATION WHERE SWI WAS
F604 BE7006            374  CONTIN LDS    SP       ;IN CASE SP WAS MODIFIED 
                        VIA SET COMMAND
F607 3B                375         RTI
                       376  
                       377  ;*****
                       378  ;DISPLAY - DISPLAY MEMORY DATA
F608 BDFAFC            379  DISPLA JSR    GTRANG   ;GET MEMORY DISPLAY RANGE
F60B 2F60              380         BLE    DISPL9   ;ADDRESS IS REQUIRED
                       381  
                       382  ;INITIALIZE ADDRESS POINTER TO START OF MEMORY
F60D FE7015            383         LDX    RANGLO
F610 FF70B8            384         STX    MEMADR
                       385  
                       386  ;SEARCH LIST 6 FOR DISPLAY MODIFIERS "DATA" OR "
 USED"
F613 8606              387         LDAA   #6
F615 BDF9C7            388         JSR    COMAND
F618 2B53              389         BMI    DISPL9   ;ANY OTHER MODIFIER IS IL
                        LEGAL
                       390  ;ADJ DISPLAY MODIFIER CODE SO THAT: -1=ADDR & DA
 TA, 0=DATA, I=USED
F61A 4A                391         DECA
F61B B770D6            392         STAA   COMNUM   ;SAVE FOR LATER TESTS
                       393  ;INIT "DATA VALUES PER LINE" COUNTER
F61E 5F                394         CLRB
F61F 5C                395         INCB
F620 CE70B8            396  DISPL1 LDX    #MEMADR
F623 7D70D6            397         TST    COMNUM   ;WHICH DISPLAY OPTION?
F626 2B2C              398         BMI    DISPL6   ;IF "ADDRESS & DATA", GO 
                        THERE
                       399  
                       400  ;OUTPUT DATA WITH ADDRESS ONLY AT LINE BEGINNING
F628 5A                401         DECB            ;COUNT DATA VALUES PER LI
                        NE
F629 260C              402         BNE    DISPL2   ;IF COUNT NOT UP, SKIP AD
                        DRESS OUTPUT
                       403  
F62B BDFEC7            404         JSR    DOCRLF   ;GET TO LINE BEGINNING
F62E BDFC04            405         JSR    OUT2BY   ;OUTPUT ADDRESS
F631 BDFBF1            406         JSR    OUTSP    ;AND A SPACE
F634 F67012            407         LDAB   DBNBR    ;RESET LINE COUNTER
                       408  
F637 FE70B8            409  DISPL2 LDX    MEMADR   ;POINT TO DATA AT THAT AD
                        DRESS
F63A 7D70D6            410         TST    COMNUM   ;WANT "DATA" OPTION?
F63D 2E05              411         BGT    DISPL3   ;IF NOT, GO TO "USES" COD
                        E
                       412  
                       413  ;"DATA" OPTION
F63F BDFBF1            414         JSR    OUTSP    ;OUTPUT PRECEDING SPACE
F642 201B              415         BRA    DISPL7
                       416  ;"USED" OPTION
F644 A600              417  DISPL3 LDAA   ,X       ;GET THE DATA
F646 4D                418         TSTA            ;EXAMINE IT FOR ZERO
F647 2604              419         BNE    DISPL4
F649 862E              420         LDAA   #'.'     ;ITS ZERO, GET A "."
F64B 2002              421         BRA    DISPL5
F64D 862B              422  DISPL4 LDAA   #'+'     ;ITS NON-ZERO. GET A "+"
F64F BDFE76            423  DISPL5 JSR    OUTCHR   ;OUTPUT THE "." OR "+"


Crasm 1.8:                           MONDEB                  page  9

F652 200E              424         BRA    DISPL8
                       425  
F654 BDFBF1            426  DISPL6 JSR    OUTSP    ;OUTPUT A PRECEDING SPACE
F657 BDFC04            427         JSR    OUT2BY   ;TYPE ADDRESS
F65A BDFBF7            428         JSR    OUTEQ    ;TYPE "="
F65D EE00              429         LDX    ,X       ;GET CONTENT
F65F BDFBFD            430  DISPL7 JSR    OUT1BY   ;TYPE IT
                       431  
F662 BC7017            432  DISPL8 CPX    RANGHI   ;ARE WE DONE?
F665 2709              433         BEQ    DISP10   ;IF YES, BACK TO PROMPT
F667 08                434         INX             ;NO, INC MEMORY ADDRESS
F668 FF70B8            435         STX    MEMADR   ;SAVE IT
F66B 20B3              436         BRA    DISPL1
                       437  
F66D 7EF457            438  DISPL9 JMP    BADSYN
F670 7EF46F            439  DISP10 JMP    NOMORE
                       440  
                       441  ;*****
                       442  ;SET - SET MEMORY LOCATIONS
F673 BDFAFC            443  SET    JSR    GTRANG   ;GET MEMORY LOCATION/RANG
                        E
F676 2B4E              444         BMI    SET5     ;IF NOT AN ADDRESS, LOOK 
                        FOR A REGISTER NAME
F678 27F3              445         BEQ    DISPL9   ;AN ADDRESS MODIFIER IS R
                        EQUIRED
                       446  
                       447  ;RANGE OF ADDRESSES SPECIFIED?
F67A FE7015            448         LDX    RANGLO
F67D BC7017            449         CPX    RANGHI
F680 2712              450         BEQ    SET2     ;IF SINGLE ADDRESS, SET U
                        P ADDRESSES INDIVIDUALLY
                       451  ;SET A RANGE OF ADDRESSES TO A SINGLE VALUE
F682 BDFB47            452         JSR    NUMBER   ;GET THAT VALUE
F685 2FE6              453         BLE    DISPL9   ;ITS REQUIRED
F687 B67014            454         LDAA   NBRLO    ;PUT IT IN ACCA
F68A A700              455  SET1   STAA   ,X       ;STORE IT IN DESTINATION
F68C BC7017            456         CPX    RANGHI   ;END OF RANGE HIT?
F68F 27DF              457         BEQ    DISP10   ;IF YES,ALL DONE
F691 08                458         INX             ;NO, ON TO NEXT ADDRESS I
                        N RANGE
F692 20F6              459         BRA    SET1     ;LOOP TO SET IT
                       460  ;SET ADDRESSES UP INDIVIDUALLY
F694 FF70B8            461  SET2   STX    MEMADR   ;SAVE MEMORY LOC
F697 BDFB47            462  SET3   JSR    NUMBER   ;GET DATA TO PUT THERE
F69A 270D              463         BEQ    SET4     ;END OF LINE?
F69C 2DCF              464         BLT    DISPL9   ;ABORT IF BAD SYNTAX
F69E B67014            465         LDAA   NBRLO    ;LOAD DATA BYTE
F6A1 FE70B8            466         LDX    MEMADR   ;LOAD ADDRESS
F6A4 A700              467         STAA   ,X       ;STORE DATA
                       468  
                       469  ;INCREMENT ADDRESS IN CASE USER WANTS TO INDIVID
 UALLY SET SEVERAL
                       470  ;SUCCESSIVE LOCATIONS
F6A6 08                471         INX
F6A7 20EB              472         BRA    SET2
                       473  
                       474  ;END OF LINE - WAS IT TERMINATED WITH A LINE FEE
 D?
F6A9 FE700A            475  SET4   LDX    SYNPTR   ;POINT TO END OF LINE
F6AC A600              476         LDAA   ,X       ;GET CHAR THERE
F6AE 810A              477         CMPA   #LF      ;LINE FEED?
F6B0 266B              478         BNE    SET12    ;IF NOT, BACK TO PROMPT


Crasm 1.8:                           MONDEB                  page 10

F6B2 CE70B8            479         LDX    #MEMADR  ;YES, GET NEXT ADDRESS TO
                        BE SET
F6B5 BDFC04            480         JSR    OUT2BY   ;TYPE IT
F6B8 BDFBF1            481         JSR    OUTSP    ;AND A SPACE
F6BB BDFD8C            482         JSR    GETLIN   ;GET A NEW LINE
F6BE FE702C            483         LDX    BUFBEG   ;GET BUFFER BEGINNING
F6C1 FF700A            484         STX    SYNPTR   ;EQUATE IT TO SYNTAX SCAN
                        POINTER
F6C4 20D1              485         BRA    SET3     ;GO PICK UP DATA
                       486  
                       487  
                       488  ;LOOK FOR (REGISTER NAME, REGISTER VALUE) PAIRS
F6C6 8605              489  SET5   LDAA   #5
F6C8 BDF9C7            490         JSR    COMAND   ;PICK UP A REGISTER NAME
F6CB 2B4D              491         BMI    SET11    ;ERROR IF UNRECOGNIZABLE
F6CD 274E              492         BEQ    SET12    ;DONE IF END OF LINE
F6CF 36                493         PSHA            ;SAVE REGISTER NAME(NUMBE
                        R)
F6D0 BDFB47            494         JSR    NUMBER   ;GET NEW REGISTER VALUE
F6D3 32                495         PULA            ;RESTORE REGISTER NAME(NU
                        MBER)
F6D4 2F44              496         BLE    SET11    ;GOT GOOD REGISTER VALUE?
F6D6 FE7006            497         LDX    SP       ;YES, POINT TO TOP OF STA
                        CK
F6D9 F67014            498         LDAB   NBRLO    ;GET REGISTER VALUE
                       499  
                       500  ;CONDITION CODES
F6DC 8101              501         CMPA   #1
F6DE 2604              502         BNE    SET6
F6E0 E701              503         STAB   1,X
F6E2 20E2              504         BRA    SET5
                       505  ;ACCB
F6E4 8102              506  SET6   CMPA   #2
F6E6 2604              507         BNE    SET7
F6E8 E702              508         STAB   2,X
F6EA 20DA              509         BRA    SET5
                       510  
                       511  ;ACCA
F6EC 8103              512  SET7   CMPA   #3
F6EE 2604              513         BNE    SET8
F6F0 E703              514         STAB   3,X
F6F2 20D2              515         BRA    SET5
                       516  
                       517  ;IX
F6F4 8104              518  SET8   CMPA   #4
F6F6 2609              519         BNE    SET9
F6F8 B67013            520         LDAA   NBRHI
F6FB A704              521         STAA   4,X      ;UPDATE HI BYTE
F6FD E705              522         STAB   5,X      ;UPDATE LO BYTE
F6FF 20C5              523         BRA    SET5
                       524  
                       525  ;PC
F701 8105              526  SET9   CMPA   #5
F703 2609              527         BNE    SET10
F705 B67013            528         LDAA   NBRHI
F708 A706              529         STAA   6,X      ;UPDATE HI BYTE
F70A E707              530         STAB   7,X      ;UPDATE LO BYTE
F70C 20B8              531         BRA    SET5
                       532  
                       533  ;SP
F70E 8106              534  SET10  CMPA   #6
F710 2608              535         BNE    SET11


Crasm 1.8:                           MONDEB                  page 11

F712 FE7013            536         LDX    NBRHI    ;DON'T NEED IX TO SET SP
F715 FF7006            537         STX    SP
F718 20AC              538         BRA    SET5
                       539  
F71A 7EF457            540  SET11  JMP    BADSYN
F71D 7EF46F            541  SET12  JMP    NOMORE
                       542  ;*****
                       543  ;VERIFY - CHECKSUM VERIFY A BLOCK OF MEMORY
F720 BDFAFC            544  VERIFY JSR    GTRANG   ;GET A NUMBER RANGE
F723 271B              545         BEQ    VERIF1   ;NO MODIFIER MEANS CHECK 
                        WHAT WE HAVE
F725 2BF3              546         BMI    SET11    ;ANYTHING ELSE IS ILLEGAL
                       547  ;GOOD RANGE GIVEN, TRANSFER IT TO CHECKSUM ADDRE
 SSES
F727 FE7015            548         LDX    RANGLO
F72A FF701B            549         STX    VERFRM
F72D FE7017            550         LDX    RANGHI
F730 FF701D            551         STX    VERTO
                       552  
F733 8D22              553         BSR    CKSUM    ;COMPUTE CHECKSUM
F735 B7701F            554         STAA   CHKSUM   ;SAVE IT
F738 CE701F            555         LDX    #CHKSUM  ;TYPE THE CHECKSUM
F73B BDFBFD            556         JSR    OUT1BY
F73E 20DD              557         BRA    SET12
                       558  
                       559  ;NO MODIFIER GIVEN - JUST VERIFY CHECKSUM
F740 8D15              560  VERIF1 BSR    CKSUM    ;COMPUTE CHECKSUM
F742 B1701F            561         CMPA   CHKSUM   ;SAME AS STORED CHECKSUM?
F745 2608              562         BNE    VERIF2
                       563  
                       564  ;THEY VERIFY - SAY SO
F747 CEFF1F            565         LDX    #MSGVER
F74A BDFE4B            566         JSR    OUTSTR
F74D 20CE              567         BRA    SET12
                       568  
                       569  ;THEY DON'T - SAY SO
F74F CEFF22            570  VERIF2 LDX    #MSGNVE
F752 BDFE4B            571         JSR    OUTSTR
F755 20C6              572         BRA    SET12
                       573  
                       574  ;COMPUTE THE CHECKSUM FROM ADDRESSES VERFRM TO V
 ERTO
                       575  ;RETURN THE CHECKSUM IN ACCA
F757 4F                576  CKSUM  CLRA            ;INIT CHECKSUM TO ZERO
F758 FE701B            577         LDX    VERFRM   ;GET FIRST ADDRESS
F75B 09                578         DEX             ;INIT TO ONE LESS
F75C 08                579  CKSUM1 INX             ;START OF CHECKSUM LOOP
F75D AB00              580         ADDA   ,X       ;UPDATE CHECKSUM IN ACCA 
                        WITH BYTE POINTED TO
F75F BC701D            581         CPX    VERTO    ;HIT END OF RANGE?
F762 26F8              582         BNE    CKSUM1   ;IF NOT, LOOP BACK
F764 43                583         COMA            ;COMPLEMENT THE SUM
F765 39                584         RTS             ;RETURN WITH IT
                       585  ;*****
                       586  ;SEARCH - SEARCH MEMORY FOR A BYTE STRING
                       587  
                       588  ;GLOBAL VARIABLES USED
                       589  ;LINPTR - INPUT LINE CHARACTER POINTER
                       590  ;LISPTR - COMMAND LIST CHARACTER POINTER
                       591  ;RANGLO - "SEARCH FROM" ADDRESS
                       592  ;RANGHI - "SEARCH TO" ADDRESS
                       593  


Crasm 1.8:                           MONDEB                  page 12

                       594  ;LOCAL VARIABLES USE
                       595  ;MEMADR - STARTING MEMORY ADDRESS WHERE A MATCH 
 OCCURRED
                       596  ;BYTPTR - ADDRESS POINTER USED TO FILL BYTSTR AN
 D SUBSTR BUFFERS
                       597  ;NBYTES - NUMBER OF BYTES IN BYTE STRING
                       598  ;NBRMAT - NUMBER OF CHARS THAT MATCH SO FAR IN T
 HE MATCHING PROCESS
                       599  ;BYTSTR - STARTING ADDRESS OF 6 CHARACTER BYTE S
 TRING BUFFER
                       600  
                       601  ;THE SEARCH STRING OCCUPIES TEMP4, TEMP5, & TEMP
 6 (6 BYTES MAX)
                       602  
                       603  ;GET SEARCH RANGE BEGINNING (RANGLO) & END (RANG
 HI)
F766 BDFAFC            604  SEARCH JSR    GTRANG
F769 2F7C              605         BLE    SEARC9   ;ABORT IF NO PAIR
                       606  
                       607  ;INITIALIZED BYTE STRING POINTER
F76B CE70BE            608         LDX    #BYTSTR  ;GET START OF BYTE STRING
                        TO SEARCH FOR
F76E FF70BA            609         STX    BYTPTR   ;SET POINTER TO IT
                       610  
F771 7F70BC            611         CLR    NBYTES   ;ZERO # OF BYES IN BYTE S
                        TRING
                       612  
                       613  ;GET BYTE STRING
F774 BDFB47            614  SEARC1 JSR    NUMBER   ;GET A BYTE
F777 271A              615         BEQ    SEARC2   ;BEGIN SEARCH IF EOL
F779 2D6C              616         BLT    SEARC9
                       617  
                       618  ;GOOD BYTE, ADD IT TO STRING
F77B 7C70BC            619         INC    NBYTES   ;COUNT THIS BYTE
                       620  ;DON'T ACCEPT OVER 6 BYTES
F77E B670BC            621         LDAA   NBYTES
F781 8106              622         CMPA   #6
F783 2E62              623         BGT    SEARC9
                       624  
F785 B67014            625         LDAA   NBRLO    ;GET (LOW ORDER) BYTE
F788 FE70BA            626         LDX    BYTPTR   ;GET BYTE POINTER
F78B A700              627         STAA   ,X       ;SAVE BYTE
F78D 08                628         INX             ;MOVE BYTE POINTER TO NEX
                        T LOCATION IN STRING
F78E FF70BA            629         STX    BYTPTR   ;SAVE IT
F791 20E1              630         BRA    SEARC1
                       631  
                       632  ;BEGIN SEARCH FOR BYTE STRING
                       633  ;IS # OF BYTES TO LOOK FOR >0
F793 7D70BC            634  SEARC2 TST    NBYTES
F796 274F              635         BEQ    SEARC9   ;IF NOT, BAD SYNTAX
                       636  
                       637  ;MAKE USE OF INPUT LINE CHARACTER FETCH & COMMAN
 D LIST CHAR FETCH ROUTINES
                       638  
                       639  ;INITIALIZE MEMORY POINTER TO START OF SEARCH RA
 NGE
F798 FE7015            640         LDX    RANGLO
F79B 09                641         DEX
F79C FF700C            642         STX    LINPTR
                       643  
                       644  ;INITIALIZE BYTE POINTER TO START OF BYTE STRING


Crasm 1.8:                           MONDEB                  page 13

F79F CE70BD            645  SEARC3 LDX    #BYTSTR-1
F7A2 FF70D7            646         STX    LISPTR
                       647  
F7A5 7F70BD            648         CLR    NBRMAT   ;SET "NUMBER OF BYTES THA
                        T MATCHED" TO ZERO
                       649  ;GET BYTE FROM BYTE STRING & RETURN IT IN ACCA
F7A8 BDFCCD            650         JSR    GETLST
                       651  ;GET BYTE FROM MEMORY RANGE & RETURN IT IN ACCB
F7AB BDFCC0            652  SEARC4 JSR    GETCHR
                       653  
F7AE 11                654         CBA             ;COMPARE MEMORY & BYTE ST
                        RING CHARACTERS
F7AF 2707              655         BEQ    SEARC5   ;IF NO MATCH, TEST FOR RA
                        NGE END
F7B1 BC7017            656         CPX    RANGHI   ;HAVE WE REACHED THE RANG
                        E SEARCH UPPER LIMIT?
F7B4 2734              657         BEQ    SEAR10   ;YES, GO PROMPT FOR NEXT 
                        COMMAND
F7B6 20F3              658         BRA    SEARC4
                       659  
                       660  ;MATCH ACHIEVED - SAVE ADDRESS OF MATCH
F7B8 FF70B8            661  SEARC5 STX    MEMADR
F7BB 7C70BD            662  SEARC6 INC    NBRMAT   ;BUMP NUMBER MATCHED
F7BE B670BD            663         LDAA   NBRMAT
F7C1 B170BC            664         CMPA   NBYTES   ;HAVE ALL CHARACTERS MATC
                        HED?
F7C4 2716              665         BEQ    SEARC8   ;IF SO, MATCH ACHIEVED
                       666  ;HAVEN'T MATCHED ALL YET, GO GET NEXT PAIR EVEN 
 IF PAST "SEARCH TO" ADDRESS
F7C6 BDFCCD            667         JSR    GETLST
F7C9 BDFCC0            668         JSR    GETCHR
F7CC 11                669         CBA
F7CD 27EC              670         BEQ    SEARC6
                       671  ;MISMATCH ON SOME BYTE PAST THE FIRST ONE
                       672  ;RESET THE MEMORY POINTER TO GET NEXT UNTESTED M
 EMORY LOCATION
F7CF FE70B8            673  SEARC7 LDX    MEMADR
                       674  ;THIS TEST HANDLES SPECIAL CASE OF A MATCH ON RA
 NGE END
F7D2 BC7017            675         CPX    RANGHI
F7D5 2713              676         BEQ    SEAR10
F7D7 FF700C            677         STX    LINPTR
                       678  ;GO RESET THE BYTE STRING POINTER
F7DA 20C3              679         BRA    SEARC3
                       680  
                       681  ;MATCH ON BYTE STRING ACHIEVED, TYPE OUT MEMORY 
 ADDRESS
F7DC CE70B8            682  SEARC8 LDX    #MEMADR
F7DF BDFC04            683         JSR    OUT2BY
F7E2 BDFBF1            684         JSR    OUTSP    ;AND A SPACE
                       685  ;ASSUME A MISMATCH (I.E., RESET MEMORY & BYTE ST
 RING POINTERS & CONTINUE
F7E5 20E8              686         BRA    SEARC7
                       687  
F7E7 7EF457            688  SEARC9 JMP    BADSYN
F7EA 7EF46F            689  SEAR10 JMP    NOMORE
                       690  
                       691  ;*****
                       692  ;TEST - TEST RAM FOR BAD BYTES
                       693  ;GET AN ADDRESS RANGE
F7ED BDFAFC            694  TEST   JSR    GTRANG
F7F0 2FF5              695         BLE    SEARC9   ;ABORT IF NO PAIR


Crasm 1.8:                           MONDEB                  page 14

                       696  ;RANGLO HOLS STARTING ADDRESS OF RANGE
                       697  ;RANGHI HOLDS ENDING ADDRESS OF RANGE
F7F2 FE7015            698         LDX    RANGLO
F7F5 FF70B8            699         STX    MEMADR
                       700  ;GET BYTE STORED AT TEST LOCATION & SAVE IT
F7F8 A600              701  TEST1  LDAA   ,X
F7FA 36                702         PSHA
                       703  
F7FB 6F00              704         CLR    ,X       ;ZERO THE LOCATION
F7FD 6D00              705         TST    ,X       ;TEST IT
F7FF 2705              706         BEQ    TEST2    ;OK IF = ZERO
                       707  
                       708  ;CAN'T CLEAR LOCATION
F801 CEFF32            709         LDX    #MSGCCL
F804 201E              710         BRA    TEST4
                       711  
F806 6A00              712  TEST2  DEC    ,X       ;SET LOCATION TO FF
F808 86FF              713         LDAA   #$FF
F80A A100              714         CMPA   ,X       ;DID IT GET SET TO FF?
F80C 2705              715         BEQ    TEST3
                       716  
                       717  ;CAN'T SET LOCATION TO ONE'S
F80E CEFF3D            718         LDX    #MSGCSO
F811 2011              719         BRA    TEST4
                       720  
F813 FE70B8            721  TEST3  LDX    MEMADR   ;GET LOCATION BEING TESTE
                        D
F816 32                722         PULA
F817 A700              723         STAA   ,X       ;RESTORE PREVIOUS CONTENT
                       724  
                       725  ;HIT END OF TEST RANGE?
F819 BC7017            726         CPX    RANGHI
F81C 27CC              727         BEQ    SEAR10   ;YES, ALL DONE
                       728  
                       729  ;NO, MOVE TO TEST NEXT LOCATION
F81E 08                730         INX
F81F FF70B8            731         STX    MEMADR
F822 20D4              732         BRA    TEST1
                       733  
                       734  ;*LOCATION IS BAD
F824 FF70BC            735  TEST4  STX    TEMP3    ;SAVE ERROR MESSAGE TEMPO
                        RARILY
                       736  
F827 CE70B8            737         LDX    #MEMADR
F82A BDFC04            738         JSR    OUT2BY   ;TYPE OUT BAD ADDRESS.
F82D BDFBF7            739         JSR    OUTEQ    ;AN EQUAL SIGN
                       740  
F830 FE70B8            741         LDX    MEMADR
F833 BDFBFD            742         JSR    OUT1BY   ;ITS CONTENT.
F836 BDFBF1            743         JSR    OUTSP    ;A SPACE.
F839 FE70BC            744         LDX    TEMP3
F83C BDFE4B            745         JSR    OUTSTR   ;AND THE TYPE OF ERROR
                       746  
F83F BDFEC7            747         JSR    DOCRLF   ;SEND CR-LF
F842 20CF              748         BRA    TEST3
                       749  ;*****
                       750  ;INT - SET UP INTERRUPT POINTER
F844 BDFB3C            751  INT    JSR    NUMINX   ;GET POINTER IN IX
F847 FF7000            752         STX    INTVEC   ;SAVE IT
F84A 202C              753         BRA    COMPA1
                       754  
                       755  ;*****


Crasm 1.8:                           MONDEB                  page 15

                       756  ;NMI - SET UP NON-MASKABLE INTERRUPT POINTER
F84C BDFB3C            757  NMI    JSR    NUMINX   ;GET POINTER IN IX
F84F FF7002            758         STX    NMIVEC   ;SAVE IT
F852 2024              759         BRA    COMPA1
                       760  
                       761  ;*****
                       762  ;SWI - SET UP SWI POINTER
F854 BDFB3C            763  LSWI   JSR    NUMINX   ;GET POINTER TO IX
F857 FF7004            764         STX    SWIVEC   ;SAVE IT
F85A 201C              765         BRA    COMPA1
                       766  
                       767  ;*****
                       768  ;COMPARE - OUTPUT SUM & DIFFERENCE OF TWO INPUT 
 NUMBERS
F85C BDFB3C            769  COMPAR JSR    NUMINX   ;GET FIRST NUMBER
F85F FF7015            770         STX    RANGLO   ;PUT IT IN RANGLO
                       771  
F862 BDFB3C            772         JSR    NUMINX   ;GET SECOND NUMBER
F865 FF7013            773         STX    NBRHI    ;SAVE IT IN NBRHI
                       774  
                       775  ;COMPUTE AND OUTPUT THE SUM
F868 BDFAD6            776         JSR    SUMNUM   ;COMPUTE SUM
F86B CEFF4E            777         LDX    #MSGSIS  ;GETS ITS TITLE
F86E 8D0B              778         BSR    OUTSD    ;OUTPUT TITLE & SUM
                       779  
F870 BDFAE9            780         JSR    DIFNUM   ;COMPUTE DIFFERENCE
F873 CEFF56            781         LDX    #MSGDIS  ;GET ITS TITLE
F876 8D03              782         BSR    OUTSD    ;OUTPUT TITLE & DIFFERENC
                        E
                       783  
F878 7EF46F            784  COMPA1 JMP    NOMORE
                       785  
                       786  ;COMPUTE AND OUTPUT THE RESULT
F87B BDFE4B            787  OUTSD  JSR    OUTSTR   ;OUTPUT IT
F87E CE7017            788         LDX    #RANGHI  ;GET RESULT
F881 BDFC04            789         JSR    OUT2BY   ;DISPLAY RESULT
F884 39                790         RTS
                       791  ;*****
                       792  ;DUMP - DUMP A PORTION OF MEMORY, IN MIKBUG FORM
 AT, TO A SPECIFIED ACIA ADDRESS
                       793  
                       794  ;GET ADDRESS RANGE: START IN RANGLO (2 BYTES), E
 ND IN RANGHI (2 BYTES)
                       795  ;IF NO ADDRESS RANGE IS GIVEN, USE WHATEVER IS I
 N RANGLO & RANGHI
F885 BDFAFC            796  DUMP   JSR    GTRANG
                       797  
F888 7F70C0            798         CLR    TEMP5    ;INITIALIZE TO DUMP TO TE
                        RMINAL
                       799  
                       800  ;LOOK FOR A "TO" MODIFIER
F88B 8602              801  DUMP1  LDAA   #2
F88D BDF9C7            802         JSR    COMAND
F890 2713              803         BEQ    DUMP4
F892 2F7C              804  DUMP2  BLE    DUMP10   ;ERROR IF BAD SYNTAX
F894 8101              805         CMPA   #1       ;TO?
F896 2702              806         BEQ    DUMP3
F898 20F1              807         BRA    DUMP1    ;GO LOOK FOR ANOTHER MODI
                        FIER
                       808  
F89A BDFB3C            809  DUMP3  JSR    NUMINX   ;GET "TO" ADDRESS
F89D FF7027            810         STX    OUTADR   ;SAVE IT


Crasm 1.8:                           MONDEB                  page 16

F8A0 7C70C0            811         INC    TEMP5    ;REMEMBER THIS
F8A3 20E6              812         BRA    DUMP1    ;GO LOOK FOR ANOTHER MODI
                        FIER
                       813  
F8A5 7D70C0            814  DUMP4  TST    TEMP5
F8A8 2703              815         BEQ    DUMP5
F8AA 7C7026            816         INC    OUTFLG   ;SET FLAG FOR PROPER OUTP
                        UT DEVICE
F8AD 8D64              817  DUMP5  BSR    NULLS    ;SEND SOME NULLS
                       818  
                       819  ;MIKBUG MODE
                       820  ;OUTPUT AN "S0" TYPE RECORD
F8AF CEFF60            821         LDX    #MSGS0
F8B2 BDFE4B            822         JSR    OUTSTR
                       823  
                       824  ;COMPUTER # OF BYTES TO OUTPUT (RANGE END - RANG
 E START + 1)
                       825  ;SUBTRACT LO BYTES
F8B5 B67018            826  DUMP6  LDAA   RANGHI+1
F8B8 B07016            827         SUBA   RANGLO+1
                       828  ;SUBTRACT HI BYTES
F8BB F67017            829         LDAB   RANGHI
F8BE F27015            830         SBCB   RANGLO
                       831  ;NON-ZERO HI BYTE IMPLIES LOTS TO OUTPUT
F8C1 2604              832         BNE    DUMP7
                       833  ;HI BYTE DIFF IS ZERO
F8C3 8110              834         CMPA   #16      ;LO BYTE OF DIFF 0 TO 15
F8C5 2502              835         BCS    DUMP8    ;IF YES, TO DUMP8
F8C7 860F              836  DUMP7  LDAA   #15      ;NO, LO BYTE IS 16-255; S
                        ET BYTES TO 15
                       837  ;TO GET FRAME COUNT, ADD 1 (DIFF OF 0 IMPLIES 1 
 OUTPUT) + # OF DATA BYTES,
                       838  ; + 2 ADDR BYTES + 1 CHECKSUM BYTE
F8C9 8B04              839  DUMP8  ADDA   #4
F8CB B770BC            840         STAA   TEMP3    ;TEMP3 IS THE FRAME COUNT
F8CE 8003              841         SUBA   #3
F8D0 B770BE            842         STAA   TEMP4    ;TEMP4 IS THE RECORD BYTE
                        COUNT
                       843  ;OUTPUT A MIKBUG "S1" HEADER DATA RECORD
F8D3 CEFF74            844         LDX    #MSGS1
F8D6 BDFE4B            845         JSR    OUTSTR
F8D9 5F                846         CLRB            ;ZERO CHECKSUM
                       847  ;PUNCH FRAME COUNT
F8DA CE70BC            848         LDX    #TEMP3
F8DD 8D3E              849         BSR    OUTP2
                       850  
                       851  ;PUNCH ADDRESS
F8DF CE7015            852         LDX    #RANGLO
F8E2 8D39              853         BSR    OUTP2
F8E4 8D37              854         BSR    OUTP2
                       855  
                       856  ;OUTPUT DATA
F8E6 FE7015            857         LDX    RANGLO
F8E9 8D32              858  DUMP9  BSR    OUTP2    ;OUTPUT DATA BYTE
F8EB 7A70BE            859         DEC    TEMP4    ;DEC BYTE COUNT
F8EE 26F9              860         BNE    DUMP9
                       861  
                       862  ;COMPLEMENT AND PUNCH THE CHECKSUM
F8F0 FF7015            863         STX    RANGLO   ;SAVE MEMORY POINTER
F8F3 53                864         COMB            ;COMPLEMENT CHECKSUM
F8F4 37                865         PSHB            ;PUT IT ON STACK
F8F5 30                866         TSX             ;LET IX POINT TO IT


Crasm 1.8:                           MONDEB                  page 17

F8F6 8D25              867         BSR    OUTP2    ;OUTPUT CHECKSUM
F8F8 33                868         PULB            ;PULL IT OFF STACK
F8F9 FE7015            869         LDX    RANGLO   ;RESTORE MEMORY POINTER
F8FC 09                870         DEX
F8FD BC7017            871         CPX    RANGHI   ;HIT END OF RANGE?
F900 26B3              872         BNE    DUMP6
                       873  
                       874  ;YES, OUTPUT AN "S9" RECORD
F902 CEFF7B            875         LDX    #MSGS9
F905 BDFE4B            876         JSR    OUTSTR
F908 8D09              877         BSR    NULLS    ;GENERATE BLANK TAPE
F90A 7F7026            878         CLR    OUTFLG   ;SET TO TERMINAL OUTPUT
F90D 7EF46F            879         JMP    NOMORE   ;ALL DONE
F910 7EF457            880  DUMP10 JMP    BADSYN   ;BAD SYNTAX
                       881  
                       882  ;SEND A STRING OF NULLS
F913 C61E              883  NULLS  LDAB   #30
F915 4F                884         CLRA
F916 BDFE76            885  NULLS1 JSR    OUTCHR
F919 5A                886         DECB
F91A 26FA              887         BNE    NULLS1
F91C 39                888         RTS
                       889  
                       890  ;OUTPUT A BYTE POINTED TO BY IX AS 2 HEX CHARACT
 ERS
F91D EB00              891  OUTP2  ADDB   ,X       ;UPDATE CHECKSUM
F91F BDFBFD            892         JSR    OUT1BY
F922 08                893         INX
F923 39                894         RTS
                       895  ;*****
                       896  ;LOAD - LOAD A MIKBUG TAPE
                       897  ;LOOK FOR A "FROM" MODIFIER
F924 8607              898  LOAD   LDAA   #7       ;IN LIST 7
F926 BDF9C7            899         JSR    COMAND
F929 2BE5              900         BMI    DUMP10   ;ERROR, UNRECOGNIZABLE MO
                        DIFIER
F92B 2728              901         BEQ    LOAD2
                       902  
F92D BDFB3C            903         JSR    NUMINX   ;GET "FROM" ADDRESS
F930 FF7024            904         STX    INPADR   ;SAVE IT
F933 7C7023            905         INC    INPFLG   ;SET FLAG FOR NON-TERMINA
                        L ACIA
                       906  
                       907  ;KEEP READING CHARACTERS UNTIL AN "S" IS READ
F936 BDFE59            908  LOAD1  JSR    INPCHR   ;GET A CHAR
F939 8153              909         CMPA   #'S'     ;IS IT AN S?
F93B 26F9              910         BNE    LOAD1
                       911  
                       912  ;GOT AN "S", EXAMINE NEXT CHARACTER
F93D BDFE59            913         JSR   INPCHR
F940 8139              914         CMPA   #'9'     ;DONE IF ITS A "9"
F942 272E              915         BEQ    LOAD4
                       916  
F944 8131              917         CMPA   #'1'     ;IS IT A "1"?
F946 26EE              918         BNE    LOAD1    ;IF NOT, LOOK FOR NEXT "S
                        "
                       919  ;VALID S1 RECORD
F948 7F70E1            920         CLR    CKSM     ;CLEAR CHECKSUM
                       921  ;READ RECORD BYTE COUNT
F94B BDF986            922         JSR    RDBYTE
F94E 8002              923         SUBA   #2
F950 B770E0            924         STAA   BYTECT   ;SAVE COUNT MINUS 2 ADDRE


Crasm 1.8:                           MONDEB                  page 18

                        SS BYTES
                       925  
F953 8D23              926         BSR    BLDADR   ;BUILD ADDRESS
                       927  
F955 8D2F              928  LOAD2  BSR    RDBYTE   ;READ A DATA BYTE INTO AC
                        CA
F957 7A70E0            929         DEC    BYTECT   ;COUNT IT
F95A 2705              930         BEQ    LOAD3    ;IF DONE WITH RECORD, CHE
                        CK CHECKSUM
F95C A700              931         STAA   ,X       ;NOT DONE, STORE BYTE IN 
                        MEMORY
F95E 08                932         INX             ;ON TO NEXT MEMORY ADDRES
                        S
F95F 20F4              933         BRA    LOAD2
                       934  
                       935  ;RECORD READ IN COMPLETE
F961 7C70E1            936  LOAD3  INC    CKSM     ;TEST CHECKSUM BY ADDING 
                        1
F964 27D0              937         BEQ    LOAD1    ;IF OK, RESULT SHOULD BE 
                        ZERO
                       938  
                       939  ;RECORD CHECKSUM ERROR
F966 CEFF22            940         LDX    #MSGNVE  ;SAY SO
F969 BDFE4B            941         JSR    OUTSTR
F96C CE70B8            942         LDX    #TEMP1   ;GET RECORD ADDRESS OF IT
F96F BDFC04            943         JSR    OUT2BY   ;TYPE IT TOO
F972 7F7023            944  LOAD4  CLR    INPFLG   ;RESET FLAG TO NORMAL TER
                        MINAL INPUT
F975 7EF46F            945         JMP    NOMORE
                       946  
                       947  ;BUILD ADDRESS
F978 8D0C              948  BLDADR BSR    RDBYTE
F97A B770B8            949         STAA   TEMP1
F97D 8D07              950         BSR    RDBYTE
F97F B770B9            951         STAA   TEMP1+1
F982 FE70B8            952         LDX    TEMP1
F985 39                953         RTS
F986 8D10              954  RDBYTE BSR    INHEX    ;GET LEFT HEX DIGIT
                       955  ;MOVE TO HI 4 BITS
F988 48                956         ASLA
F989 48                957         ASLA
F98A 48                958         ASLA
F98B 48                959         ASLA
F98C 16                960         TAB             ;SAVE IT IN ACCA
F98D 8D09              961         BSR    INHEX    ;GET RIGHT HEX DIGIT
F98F 1B                962         ABA             ;COMBINE THEM IN ACCA
                       963  ;UPDATE THE CHECKSUM
F990 16                964         TAB
F991 FBF757            965         ADDB   CKSUM
F994 F7F757            966         STAB   CKSUM
F997 39                967         RTS
                       968  
                       969  ;INPUT A HEX CHAR & CONVERT TO INTERNAL FORM
F998 BDFE59            970  INHEX  JSR    INPCHR   ;INPUT A CHAR
F99B 8030              971         SUBA   #$30
F99D 2B0F              972         BMI    INHEX2   ;NOT HEX IF BELOW ASCII "
                        1"
F99F 8109              973         CMPA   #$09
F9A1 2F0A              974         BLE    INHEX1   ;OK IF ASCII "9" OR LESS
F9A3 8111              975         CMPA   #$11     ;BELOW ASCII "A"?
F9A5 2B07              976         BMI    INHEX2   ;ERROR IF IT IS
F9A7 8116              977         CMPA   #$16     ;OVER ASCII "F"?


Crasm 1.8:                           MONDEB                  page 19

F9A9 2E03              978         BGT    INHEX2   ;ERROR IF IT IS
F9AB 8007              979         SUBA   #7       ;CONVERT ASCII A-F TO HEX
                        A-F
F9AD 39                980  INHEX1 RTS
                       981  ;ERROR - CHAR NOT HEX, SAY SO
F9AE CEFF8B            982  INHEX2 LDX    #MSGCNH
F9B1 BDFE4B            983         JSR    OUTSTR
F9B4 39                984         RTS
                       985  
                       986  ;*****
                       987  ;DELAY - DELAY SPECIFIED # OF MILLISECONDS
F9B5 BDFB3C            988  DELAY  JSR    NUMINX   ;GET DELAY TIME
F9B8 8D03              989         BSR    TIMDEL
F9BA 7EF46F            990         JMP    NOMORE
                       991  
                       992  ;**
                       993  ;TIME DELAY SUBROUTINE
                       994  ;IX IS INPUT AS THE # OF MILLISECONDS TO DELAY
                       995  ;ACCA IS ALTERED
                       996  ;ACCB IS PRESERVED
                       997  ;ADJ TIMCON SO (6*TIMCON*CYCLE TIME=1 MS)
F9BD B670DE            998  TIMDEL LDAA   TIMCON
                       999  ;ENTER A 6 CYCLE LOOP
F9C0 4A               1000  TIMDE1 DECA
F9C1 26FD             1001         BNE    TIMDE1
                      1002  
F9C3 09               1003         DEX             ;DECREMENT MILLISECOND CO
                        UNTER
F9C4 26F7             1004         BNE    TIMDEL
F9C6 39               1005         RTS
                      1006  
                      1007  ;===============================================
 =====
                      1008  
                      1009  ;  C O M M A N D     L I S T     S C A N N I N G
   R O U T I N E
                      1010  
                      1011  ;THIS ROUTINE SEEKS A MATCH OF THE CHARACTERS PO
 INTED AT
                      1012  ;BY THE INPUT LINE SCANNING POINTER TO ONE OF TH
 E COMMANDS
                      1013  ;IN A LIST SPECIFIED BY ACCA.
                      1014  ;
                      1015  ; AS FOLLOWS:
                      1016  ;
                      1017  ;      ACCA=-1: THE MATCH WAS UNSUCCESSFUL.  THE
       SYNTAX
                      1018  ;               POINTER (SYNPTR) WAS NOT UPDATED
                (ADVANCED).
                      1019  ;
                      1020  ;      ACCA= 0: THE MATCH WAS UNSUCCESSFUL SINCE
       THERE WERE
                      1021  ;               NO MORE CHARACTERS, I.E., THE EN
                D OF THE
                      1022  ;               LINE WAS REACHED.
                      1023  ;
                      1024  ;      ACCA=+N: SUCCESSFUL MATCH.  THE SYNTAX PO
       INTER WAS UPDATED
                      1025  ;               TO THE FIRST CHARACTER FOLLOWING
                THE COMMAND
                      1026  ;               DELIMITER.  ACCA HOLDS THE NUMBE
                R OF THE


Crasm 1.8:                           MONDEB                  page 20

                      1027  ;               COMMAND MATCHED.
                      1028  ;GLOBAL VARIABLES FOR EXTERNAL COMMUNICATION
                      1029  ;SYNPTR - GOOD SYNTAX INPUT CHAR LINE POINTER
                      1030  ;LINPTR - INPUT LINE CHARACTER POINTER
                      1031  ;DELIM - CLASS OF PERMISSIBLE COMMAND DELIMITERS
                      1032  
                      1033  ;TEMPORARY 2 BYTE INTERNAL VARIABLES
                      1034  ;LISPTR - COMMAND LIST CHARACTER POINTER
                      1035  
                      1036  ;TEMPORARY 1 BYTE INTERNAL VARIABLES
                      1037  ;NUMMAT - NUMBER OF CHARACTERS THAT SUCCESSFULLY
 MATCH
                      1038  ;LISNUM - # OF LIST WITHIN WHICH A MATCH WILL BE
 SOUGHT
                      1039  ;COMNUM - COMMAND NUMBER MATCHED
                      1040  
                      1041  ;CONSTANTS USED
                      1042  ;CR - CARRIAGE RETURN
                      1043  ;LF - LINE FEED
                      1044  
                      1045  ;ACCB & IX ARE NOT PRESERVED.
                      1046  
F9C7 B770D5           1047  COMAND STAA   LISNUM   ;SAVE LIST # TO MATCH WIT
                        HIN
                      1048  ;TEST IF WE ARE AT THE END OF THE LINE
F9CA BDFA69           1049         JSR    SKPDLM
F9CD 2402             1050         BCC    INILST
F9CF 4F               1051         CLRA
F9D0 39               1052         RTS
                      1053  
                      1054  
                      1055  ;INITIALIZE THE COMMAND LIST POINTER TO ONE LESS
 THAN
                      1056  ;                       THE BEGINNING OF THE COM
                        MAND LISTS
F9D1 FE7008           1057  INILST LDX    COMADR   ;ENTRY POINT
                      1058  
                      1059  ;MOVE TO THE BEGINNING OF THE DESIRED COMMAND LI
 ST
F9D4 B670D5           1060         LDAA   LISNUM   ;SEARCH FOR "STRING" # LI
                        SNUM
F9D7 C60A             1061         LDAB   #LF      ;USE LF AS A "STRING" TER
                        MINATOR
F9D9 8D76             1062         BSR    FNDSTR
F9DB FF70D7           1063         STX    LISPTR
                      1064  
                      1065  ;THE LIST POINTER, LISPTR, NOW POINTS TO ONE LES
 S THAN THE FIRST CHARACTER
                      1066  ;OF THE FIRST COMMAND IN THE DESIRED LIST INITIA
 LIZE THE COMMAND # TO 1
F9DE 8601             1067         LDAA   #1
F9E0 B770D6           1068         STAA   COMNUM
                      1069  
                      1070  ;RESET INPUT LINE POINTER TO: 1) BEGINNING OF LI
 NE, OR TO
                      1071  ;  2) POINT WHERE LAST SUCCESSFUL SCAN TERMINATE
   D
F9E3 FE700A           1072  CMD3   LDX    SYNPTR
F9E6 FF700C           1073         STX    LINPTR
                      1074  
F9E9 7F70D4           1075         CLR    NUMMAT   ;CLEAR NUMBER OF CHARACTE
                        RS MATCHED


Crasm 1.8:                           MONDEB                  page 21

F9EC BDFCC0           1076  CMD4   JSR    GETCHR   ;GET INPUT LINE CHAR IN A
                        CCB
F9EF BDFA94           1077         JSR    TSTDLM   ;TEST FOR A DELIMITER
F9F2 2613             1078         BNE    MATCH    ;SUCCESS (FOUND DELIMITER
                        ) IF NOT = ZERO
                      1079  
F9F4 BDFCCD           1080         JSR    GETLST   ;GET COMMAND LIST CHAR IN
                        ACCA
F9F7 810A             1081         CMPA   #LF      ;HAS END OF COMMAND LIST 
                        BEEN REACHED?
F9F9 2716             1082         BEQ    NMATCH   ;IF SO, POTENTIAL MATCH F
                        AILURE
F9FB 810D             1083         CMPA   #CR      ;HAS END OF COMMAND BEEN 
                        REACHED?
F9FD 2712             1084         BEQ    NMATCH   ;IF SO, POTENTIAL MATCH F
                        AILURE
                      1085  
F9FF 11               1086         CBA             ;COMPARE THE TWO CHARACTE
                        RS
FA00 2619             1087         BNE    NEXCOM   ;MATCH NOT POSSIBLE ON TH
                        IS COMMAND
                      1088  
                      1089  ;THEY MATCH, COMPARE THE SUCCEEDING CHARACTERS
FA02 7C70D4           1090         INC    NUMMAT   ;INC NUMBER OF CHARACTERS
                        MATCHED
FA05 20E5             1091         BRA    CMD4
                      1092  
                      1093  ;;;
                      1094  ;SUCCESSFUL MATCH - RETURN COMMAND NUMBER MATCHE
 D IN ACCA
FA07 B670D6           1095  MATCH  LDAA   COMNUM
FA0A FE700C           1096         LDX     LINPTR
FA0D FF700A           1097         STX     SYNPTR  ;UPDATE GOOD SYNTAX POINT
                        ER
FA10 39               1098         RTS
                      1099  
                      1100  ;***
                      1101  ;NO MATCH
                      1102  ;DID AT LEAST ONE MATCH?
FA11 7D70D4           1103  NMATCH TST    NUMMAT
FA14 2705             1104         BEQ    NEXCOM   ;TO NEXT COMMAND IF NONE 
                        MATCHED
                      1105  
                      1106  ;AT LEAST ONE MATCHED - TEST FOR DELIMITER (NON-
 MATCHING CHAR)
FA16 BDFA94           1107         JSR    TSTDLM
FA19 26EC             1108         BNE    MATCH    ;IF A DELIMITER, MATCH HA
                        S BEEN ACHIEVED
                      1109  ;
                      1110  ;ILLEGAL DELIMITER
                      1111  
                      1112  ;MOVE TO NEXT COMMAND WITHIN LIST
FA1B BDFCCD           1113  NEXCOM JSR    GETLST   ;GET NEXT COMMAND LIST CH
                        ARACTER
FA1E 810A             1114         CMPA   #LF      ;END OF THIS LIST?
FA20 2709             1115         BEQ    MFAIL    ;IF SO, NOTHING ON LIST M
                        ATCHED
FA22 810D             1116         CMPA   #CR      ;IS IT A CR?
FA24 26F5             1117         BNE    NEXCOM   ;IF NOT, MOVE TO NEXT CHA
                        RACTER
FA26 7C70D6           1118         INC    COMNUM   ;YES, INC COMMAND NUMBER
FA29 20B8             1119         BRA    CMD3


Crasm 1.8:                           MONDEB                  page 22

                      1120  
                      1121  ;***
                      1122  ;MATCH FAILURE - NO MATCH POSSIBLE WITHIN THIS L
 IST
FA2B 4F               1123  MFAIL  CLRA
FA2C 4A               1124         DECA
FA2D 39               1125         RTS
                      1126  
                      1127  ;===============================================
 =======
                      1128  ;THIS ROUTINE TYPES OUT COMMAND NUMBER "COMNUM"
                      1129  ;THE LIST IS SPECIFIED IN ACCA
                      1130  ;ACCB & IX ARE PRESERVED
FA2E FF70CE           1131  TYPCMD STX    XTEMP
FA31 37               1132         PSHB
FA32 CEFCD6           1133         LDX    #COMLST-1 ;MOVE TO HEAD OF COMMAND
                         LISTS
FA35 C60A             1134         LDAB   #LF      ;AND LIST TERMINATOR
FA37 8D18             1135         BSR    FNDSTR   ;GO TO HEAD OF DESIRED LI
                        ST
FA39 B670D6           1136         LDAA   COMNUM   ;GET COMMAND NUMBER
FA3C C60D             1137         LDAB   #CR      ;GET COMMAND TERMINATOR
FA3E 8D11             1138         BSR    FNDSTR   ;GO TO HEAD OF DESIRED CO
                        MMAND
                      1139  
FA40 08               1140  TYPCM1 INX             ;MOVE TO NEXT CHARACTER
FA41 A600             1141         LDAA   ,X       ;GET A COMMAND CHARACTER
FA43 810D             1142         CMPA   #CR      ;IS IT A COMMAND TERMINAT
                        OR?
FA45 2705             1143         BEQ    TYPCM2   ;IF SO, RETURN
FA47 BDFE76           1144         JSR    OUTCHR   ;NO, TYPE IT
FA4A 20F4             1145         BRA    TYPCM1
                      1146  
FA4C FE70CE           1147  TYPCM2 LDX    XTEMP
FA4F 33               1148         PULB
FA50 39               1149         RTS
                      1150  
                      1151  ;===============================================
 =======
                      1152  ;MOVE TO BEGINNING OF DESIRED STRING NUMBER (IN 
 ACCA)
                      1153  ;EACH STRING IS TERMINATED BY AN END OF STRING C
 HARACTER (IN ACCB)
                      1154  ;THE INDEX REGISTER IS ASSUMED INITIALIZED POINT
 ING TO
                      1155  ;ONE LESS THAT THE FIRST CHARACTER OF THE FIRST 
 STRING
                      1156  ;ACCA, ACCB & IX ARE NOT PRESERVED
                      1157  ;LOCAL VARIABLES
                      1158  ;STRNUM - STRING # TO FIND
                      1159  ;EOSCHR - "END OF STRING" CHARACTER
                      1160  
FA51 B770BA           1161  FNDSTR STAA   STRNUM   ;SAVE STRING NUMBER
FA54 F770BB           1162         STAB   EOSCHR   ;SAVE TERMINATOR
FA57 5F               1163         CLRB
FA58 5C               1164  FNDST1 INCB            ;STRING 1 IS THE FIRST ST
                        RING
FA59 F170BA           1165         CMPB   STRNUM   ;IS THIS THE RIGHT STRING
                        ?
FA5C 270A             1166         BEQ    FNDST3   ;IF SO, DONE
                      1167  
                      1168  ;NO, SWALLOW UP CHARACTERS UNTIL AND END OF STRI


Crasm 1.8:                           MONDEB                  page 23

 NG CHAR IS HIT
FA5E 08               1169  FNDST2 INX             ;BUMP POINTER TO NEXT ONE
FA5F A600             1170         LDAA   ,X       ;GET CHAR POINTED AT
FA61 B170BB           1171         CMPA   EOSCHR   ;END OF STRING HIT?
FA64 27F2             1172         BEQ    FNDST1   ;IF IT IS, BUMP THE STRIN
                        G COUNTER
FA66 20F6             1173         BRA    FNDST2   ;NO, MOVE ON TO NEXT CHAR
FA68 39               1174  FNDST3 RTS             ;IX SET PROPERLY, RETURN
                      1175  
                      1176  ;===============================================
 =======
                      1177  ;SKIP LEADING DELIMITERS
                      1178  ;THIS ROUTINE SHOULD BE CALLED PRIOR TO SCANNING
 FOR ANY INFORMATION
                      1179  ;ON THE INPUT LINE
                      1180  ;THE CURRENT CHARACTER IS IGNORED IF THE SCANNIN
 G POINTER IS AT THE
                      1181  ;BEGINNING OF A LINE.  IF NOT, THE SCANNING POIN
 TER SKIPS OVER SPACES
                      1182  ;AND COMMAS UNTIL AN END OF LINE OR NON-DELIMITE
 R IS FOUND.
                      1183  ;THE CARRY BIT IS SET IF AN END OF LINE IS ENCOU
 NTERED.
                      1184  
                      1185  ;ACCA, ACCB & IX ARE NOT PRESERVED
                      1186  
FA69 0C               1187  SKPDLM CLC
FA6A 7D700E           1188         TST    BOLFLG   ;AT BEGINNING OF LINE?
FA6D 2E0B             1189         BGT    SKPDL2
                      1190  
                      1191  ;LOOK AT CURRENT INPUT CHARACTER
FA6F FE700A           1192  SKPDL1 LDX    SYNPTR   ;GET POINTER TO IT
FA72 A600             1193         LDAA   ,X       ;GET CHAR
FA74 8D13             1194         BSR    TSTEOL   ;TEST FOR END OF LINE
FA76 2602             1195         BNE    SKPDL2
FA78 0D               1196         SEC             ;YES, END HIT, SET CARRY
FA79 39               1197         RTS
                      1198  ;"PEEK" AT NEXT CHAR IN LINE
FA7A E601             1199  SKPDL2 LDAB   1,X     ;GET IT
FA7C 8D16             1200         BSR    TSTDLM  ;SEE IF ITS A DELIMITER
FA7E 2601             1201         BNE    SKPDL3
FA80 39               1202         RTS            ;ITS NOT, RETURN
                      1203  
                      1204  ;NEXT CHAR IS A DELIMITER
FA81 BDFCC0           1205  SKPDL3 JSR    GETCHR   ;MOVE TO NEXT CHAR IN INP
                        UT LINE
FA84 FF700A           1206         STX    SYNPTR   ;UPDATE SYNTAX POINTER
FA87 20E6             1207         BRA    SKPDL1   ;GO TEST FOR END OF LINE
                      1208  
                      1209  ;===============================================
 =======
                      1210  ;TEST FOR END-OF-LINE CHARACTER
                      1211  ;Z BIT OF CC REG SET IF CHAR IN ACCA IS A TERMIN
 ATOR
                      1212  ;ACCA, ACCB, & IX ARE PRESERVED
FA89 810D             1213  TSTEOL CMPA   #CR      ;CARRIAGE RETURN?
FA8B 2706             1214         BEQ    TSTEO1
FA8D 810A             1215         CMPA   #LF      ;LINE FEED? (CONTINUED LI
                        NES)
FA8F 2702             1216         BEQ     TSTEO1
FA91 813B             1217         CMPA    #';'    ;FOR SEVERAL COMMANDS ON 
                        ONE LINE


Crasm 1.8:                           MONDEB                  page 24

FA93 39               1218  TSTEO1 RTS
                      1219  
                      1220  ;===============================================
 =======
                      1221  ;CHECK THE CHARACTER IN ACCB
                      1222  ;AGAINST THE DELIMITER(S) SPECIFIED BY VARIABLE 
 DELIM
                      1223  ;ACCB & IX ARE PRESERVED
                      1224  ;ACCA IS SET TO 0 IF ACCB IS NOT A DELIMITER, TO
 1 IF IT IS
                      1225  ;  IF DELIM=1, SPACE IS DELIMITER
                      1226  ;  IF DELIM-2, COMMA IS DELIMITER
                      1227  ;  IF DELIM=3, SPACE OR COMMAND IS DELIMITER
                      1228  ;  IF DELIM=4, ANY NON-ALPHANUMERIC IS A DELIMIT
   ER
                      1229  ;TEST FOR END-OF-LINE (LOGICAL OR PHYSICAL)
FA94 37               1230  TSTDLM PSHB
FA95 17               1231         TBA
FA96 8DF1             1232         BSR    TSTEOL
FA98 33               1233         PULB
FA99 2735             1234         BEQ    DLMYES
                      1235  
FA9B B6700F           1236         LDAA   DELIM
FA9E 8101             1237         CMPA   #1
FAA0 2606             1238         BNE    ISDLM2
FAA2 C120             1239         CMPB   #32      ;WANT A SPACE - IS IT?
FAA4 262D             1240         BNE    DLMNO
FAA6 2028             1241         BRA    DLMYES
                      1242  
FAA8 8102             1243  ISDLM2 CMPA   #2
FAAA 2606             1244         BNE    ISDLM3
FAAC C12C             1245  TSTCMA CMPB   #','     ;WANT A COMMA - IS IT?
FAAE 2623             1246         BNE    DLMNO
FAB0 201E             1247         BRA    DLMYES
FAB2 8103             1248  ISDLM3 CMPA   #3
FAB4 2606             1249         BNE    ISDLM4
FAB6 C120             1250         CMPB   #32      ;WANT EITHER, IS IT A SPA
                        CE?
FAB8 2716             1251         BEQ    DLMYES
FABA 20F0             1252         BRA    TSTCMA   ;OR A COMMA?
                      1253  
FABC 8104             1254  ISDLM4 CMPA   #4
FABE 2615             1255         BNE    ERROR    ;ERROR IF DELIM NOT 1-4
                      1256  ;TEST IF CHAR IS 0 TO 9 INCLUSIVE
FAC0 C130             1257         CMPB   #'0'
FAC2 2D0C             1258         BLT    DLMYES
FAC4 C139             1259         CMPB   #'9'
FAC6 2F0B             1260         BLE    DLMNO
                      1261  
                      1262  ;TEST IF CHAR IS A TO 9 INCLUSIVE
FAC8 C141             1263         CMPB   #'A'
FACA 2D04             1264         BLT    DLMYES
FACC C15A             1265         CMPB   #'Z'
FACE 2F03             1266         BLE    DLMNO
                      1267  ;OVER Z - ITS A DELIMITER
                      1268  
                      1269  ;CHAR IN ACCB IS A DELIMITER
FAD0 8601             1270  DLMYES LDAA   #1
FAD2 39               1271         RTS
                      1272  
                      1273  ;CHAR IN ACCB IS NOT A DELIMITER
FAD3 4F               1274  DLMNO  CLRA


Crasm 1.8:                           MONDEB                  page 25

FAD4 39               1275         RTS
                      1276  
                      1277  ;ERROR IN SPECIFYING DELIMITER CLASS
FAD5 3F               1278  ERROR  SWI             ;HAVE MONITOR TYPE OUT PE
                        RTINENT STATISTICS
                      1279  
                      1280  ;===============================================
 ======
                      1281  ;ADD THE 2 BYE NUMBER STORED IN (RANGLO,RANGLO+1
 ) TO THE NUMBER
                      1282  ;STORED IN (NBRHI,NBRLO) AND PUT THE RESULT IN (
 RANGHI,RANGHI+1)
                      1283  ;ACCB & IX ARE PRESERVED
                      1284  ;ACCA IS ALTERED
                      1285  
                      1286  ;ADD LO ORDER BYTES
FAD6 B67016           1287  SUMNUM LDAA   RANGLO+1
FAD9 BB7014           1288         ADDA   NBRLO
FADC B77018           1289         STAA   RANGHI+1
                      1290  
                      1291  ;ADD HI ORDER BYTES
FADF B67015           1292         LDAA   RANGLO
FAE2 B97013           1293         ADCA   NBRHI
FAE5 B77017           1294         STAA   RANGHI
                      1295  
FAE8 39               1296         RTS
                      1297  
                      1298  ;===============================================
 =========
                      1299  ;SUBTRACT THE TWO BYTE NUMBER STORED IN (NBRHI,N
 BRLO) FROM THE
                      1300  ;TWO BYTE NUMBER STORED IN (RANGLO,RANGLO+1) AND
 PUT THE
                      1301  ;RESULT IN (RANGHI,RANGHI+1)
                      1302  ;ACCB & IX ARE PRESERVED
                      1303  ;ACCA IS ALTERED
                      1304  
                      1305  ;SUBTRACT LO ORDER BYTES
FAE9 B67016           1306  DIFNUM LDAA   RANGLO+1
FAEC B07014           1307         SUBA   NBRLO
FAEF B77018           1308         STAA   RANGHI+1
                      1309  
                      1310  ;SUBTRACT HI ORDER BYES
FAF2 B67015           1311         LDAA   RANGLO
FAF5 B27013           1312         SBCA   NBRHI
FAF8 B77017           1313         STAA   RANGHI
                      1314  
FAFB 39               1315         RTS
                      1316  
                      1317  ;===============================================
 =======
                      1318  ;THIS ROUTINE SCANS THE INPUT LINE FOR A PAIR OF
 NUMBERS
                      1319  ;REPRESENTING AN ADDRESS RANGE.  A COLON SEPARAT
 ING THE
                      1320  ;PAIR IMPLIES "THRU", WHILE AN "!" IMPLIED "THRU
 THE FOLLOWING"
                      1321  ;E.G., 100:105 IS EQUIVALENT TO 100!5
                      1322  ;A SINGLE NUMBER IMPLIES A RANGE OF 1
                      1323  ;
                      1324  ;ON RETURN (RANGLO,RANGLO+1) HOLDS THE RANGE STA
 RT, AND


Crasm 1.8:                           MONDEB                  page 26

                      1325  ;          (RANGHI,RANGHI+1) HOLDS THE RANGE END
           .
                      1326  ;ACCA, ACCB, & IX ARE NOT PRESERVED
                      1327  
FAFC 8D49             1328  GTRANG BSR    NUMBER   ;PICK UP FIRST NUMBER
FAFE 2E03             1329         BGT    GTRAN1
FB00 2D09             1330         BLT    GTRAN2
FB02 39               1331         RTS             ;NOTHING MORE ON INPUT LI
                        NE
                      1332  
                      1333  ;GOOD SINGLE NUMBER - TRANSFER IT TO RANGLO
FB03 FE7013           1334  GTRAN1 LDX    NBRHI
FB06 FF7015           1335         STX    RANGLO
FB09 200D             1336         BRA    GTRAN3   ;AND TO RANGHI
                      1337  
                      1338  ;BAD NUMBER, BUT IS IT BAD DUE TO A ":" OR "!" D
 ELIMITER?
FB0B FE700C           1339  GTRAN2 LDX    LINPTR
FB0E A600             1340         LDAA   ,X
FB10 813A             1341         CMPA   #':'     ;WAS IT A COLON
FB12 260C             1342         BNE    GTRAN4   ;IF NOT, GO TEST FOR "!"
                      1343  
FB14 8D1A             1344         BSR    GTRAN8   ;WAS ":", PROCESS NUMBER 
                        & GET NEXT ONE
FB16 2F0E             1345         BLE    GTRAN5   ;ILLEGAL IF END OF LINE O
                        R NON-NUMERIC
                      1346  
                      1347  ;TRANSFER SECOND NUMBER TO RANGHI
FB18 FE7013           1348  GTRAN3 LDX    NBRHI
FB1B FF7017           1349         STX    RANGHI
FB1E 200D             1350         BRA    GTRAN7
                      1351  
FB20 8121             1352  GTRAN4 CMPA   #'!'     ;WAS DELIMITER A "!"?
FB22 2703             1353         BEQ    GTRAN6   ;IF YES, GET 2ND NUMBER
                      1354  
                      1355  ;ILLEGAL DELIMITER, RETURN
FB24 4F               1356         CLRA
FB25 4A               1357         DECA
FB26 39               1358  GTRAN5 RTS
                      1359  
FB27 8D07             1360  GTRAN6 BSR    GTRAN8   ;WAS "!", PROCESS FIRST N
                        UMBER & GET NEXT ONE
FB29 2FFB             1361         BLE    GTRAN5
FB2B 8DA9             1362         BSR    SUMNUM   ;COMPUTE RANGE END, PUT I
                        NTO RANGHI
                      1363  
                      1364  ;SUCCESSFUL EXIT
FB2D 8601             1365  GTRAN7 LDAA   #1
FB2F 39               1366         RTS
                      1367  
                      1368  ;UPDATE SYNTAX POINTER, MOVE FIRST NUMBER TO RAN
 GLO, & GET 2ND NUMBER
FB30 FF700A           1369  GTRAN8 STX    SYNPTR   ;UPDATE SYNTAX POINTER
FB33 FE7013           1370         LDX    NBRHI    ;GET FIRST NUMBER OF THE 
                        PAIR
FB36 FF7015           1371         STX    RANGLO   ;SAVE IT IN "LOW RANGE" V
                        ALUE
FB39 8D0C             1372         BSR    NUMBER   ;PICK UP THE SECOND NUMBE
                        R OF THE PAIR
FB3B 39               1373         RTS
                      1374  
                      1375  ;===============================================


Crasm 1.8:                           MONDEB                  page 27

 =======
                      1376  ;GET A 2 BYTE NUMBER & RETURN IT IN THE INDEX RE
 GISTER
FB3C 8D09             1377  NUMINX BSR    NUMBER
FB3E 2E03             1378         BGT    NUMIN1
FB40 7EF457           1379         JMP    BADSYN
FB43 FE7013           1380  NUMIN1 LDX    NBRHI
FB46 39               1381         RTS
                      1382  
                      1383  ;===============================================
 =======
                      1384  ;SCAN FOR A NUMBER
                      1385  ;RETURN THE MOST SIGNIFICANT BYTE IN NBRHI
                      1386  ;  AND THE LEAST SIGNIFICANT BYTE IN NBRLO
                      1387  ;THE RESULT OF THE SCAN FOR A NUMBER IF RETURNED
 IN
                      1388  ;ACCA AS FOLLOWS:
                      1389  ;
                      1390  ;      ACCA=-1: THE MATCH WAS UNSUCCESSFUL.  THE
       SYNTAX
                      1391  ;               POINTER (SYNPTR) WAS NOT UPDATED
                .
                      1392  ;
                      1393  ;      ACCA= 0: THE MATCH WAS UNSUCCESSFUL SINCE
       THERE WERE NO
                      1394  ;               MORE CHARACTERS. (I.E., THE END 
                OF THE
                      1395  ;               LINE WAS ENCOUNTERED.)
                      1396  ;
                      1397  ;      ACCA=+1: THE SCAN WAS SUCCESSFUL.  THE SY
       NTAX POINTER
                      1398  ;               WAS UPDATED TO THE FIRST CHARACT
                ER FOLLOWING
                      1399  ;               THE COMMAND.
                      1400  
                      1401  ;IX IS PRESERVED
                      1402  ;GLOBAL VARIABLES FOR EXTERNAL COMMUNICATION
                      1403  ;NBRHI - NUMBER HI BYTE
                      1404  ;NBRLO - NUMBER LO BYTE
                      1405  ;IBCODE - INPUT BASE CODE
                      1406  ;DBCODE - DISPLAY BASE CODE
                      1407  
                      1408  ;LOCAL VARIABLES
                      1409  ;NBR2X - USED IN DECIMAL CONVERSION
                      1410  ;XTEMP2 - SAVES IX
                      1411  
                      1412  ;INITIALIZE BOTH BYTES TO ZERO
FB47 FF70D2           1413  NUMBER STX    XTEMP2   ;SAVE IX
FB4A 7F7013           1414         CLR    NBRHI
FB4D 7F7014           1415         CLR    NBRLO
                      1416  
                      1417  ;INITIALIZE THE LINE SCANNING POINTER
FB50 FE700A           1418         LDX    SYNPTR
FB53 FF700C           1419         STX    LINPTR
                      1420  
                      1421  ;ARE WE AT END OF LINE?
FB56 BDFA69           1422         JSR    SKPDLM
FB59 2405             1423         BCC    NUMLUP
FB5B FE70D2           1424         LDX    XTEMP2
FB5E 4F               1425         CLRA            ;YES, ZERO ACCA
FB5F 39               1426         RTS
                      1427  


Crasm 1.8:                           MONDEB                  page 28

FB60 BDFCC0           1428  NUMLUP JSR    GETCHR   ;GET A CHARACTER FROM THE
                        INPUT LINE INTO ACCB
                      1429  
                      1430  ;TEST FOR A DELIMITER
FB63 BDFA94           1431         JSR    TSTDLM
FB66 2665             1432         BNE    GUDNUM   ;GOOD DELIMITER IF ACCA N
                        ON-ZERO
                      1433  
                      1434  ;NOT A DELIMITER, TEST IF CHARACTER IS < ASCII 0
FB68 C030             1435         SUBB   #'0'     ;SUBTRACT ASCII 0
FB6A 2B6D             1436         BMI    CONERR   ;ERROR IF LESS
                      1437  
                      1438  ;DETERMINE INPUT BASE & GO TO RIGHT ROUTINE
FB6C B67010           1439         LDAA   IBCODE
FB6F 8101             1440         CMPA   #1
FB71 2708             1441         BEQ    HEXNUM
                      1442  
FB73 8102             1443         CMPA   #2
FB75 271E             1444         BEQ    DECNUM
                      1445  
FB77 8103             1446         CMPA   #3
FB79 2741             1447         BEQ    OCTNUM
                      1448  
                      1449  ;DEFAULT AN ILLEGAL INPUT BASE TO HEX
                      1450  ;*****
                      1451  ;INPUT A HEX NUMBER
                      1452  ;TEST FOR A LEGAL DIGIT
FB7B C109             1453  HEXNUM CMPB   #$09
FB7D 2F0A             1454         BLE    HEXN1    ;OR IF 9 OR LESS
FB7F C111             1455         CMPB   #$11
FB81 2B56             1456         BMI    CONERR    ;NOT HEX IF < A
FB83 C116             1457         CMPB   #$16
FB85 2E52             1458         BGT    CONERR    ;NOT HEX IF > F
FB87 C007             1459         SUBB   #7        ;MOVE A-F ABOVE 0-9
                      1460  
                      1461  ;SHIFT LO & HI BYTES LEFT 4 BITS
FB89 8D54             1462  HEXN1  BSR    SHIFT2
FB8B 8D52             1463         BSR    SHIFT2
                      1464  
FB8D FA7014           1465         ORAB   NBRLO
FB90 F77014           1466         STAB   NBRLO
                      1467  
FB93 20CB             1468         BRA    NUMLUP
                      1469  
                      1470  ;*****
                      1471  ;INPUT A DECIMAL NUMBER
                      1472  ;TEST FOR A LEGAL DIGIT
FB95 C109             1473  DECNUM CMPB   #$09
FB97 2E40             1474         BGT    CONERR   ;NOT DECIMAL IF > 9
                      1475  
                      1476  ;MULTIPLE SAVED VALUE BY 10 & ADD IN NEW DIGIT
                      1477  ;NOTE THAT 10X=2X+8x
                      1478  ;MULTIPLY CURRENT NUMBER BY 2 TO GET 2X VALUE
FB99 8D49             1479         BSR    SHIFT
                      1480  ;SAVE THIS *2 NUMBER TEMPORARILY
FB9B FE7013           1481         LDX    NBRHI
FB9E FF70DC           1482         STX    NBR2X
                      1483  ;MULTIPLY THIS # BY 4 TO GET 8X VALUE
FBA1 8D3C             1484         BSR    SHIFT2
                      1485  ;(NBRHI,NBRLO) NOW HOLDS *8
                      1486  ;GENERATE DIGIT+8x+2x
FBA3 4F               1487         CLRA            ;ACCA WILL HOLD MS BYTE


Crasm 1.8:                           MONDEB                  page 29

FBA4 FB70DD           1488         ADDB   NBR2X+1  ;ADD 2X LS BYTE TO DIGIT
FBA7 B970DC           1489         ADCA   NBR2X    ;ADD 2X MS BYTE
FBAA 252D             1490         BCS    CONERR   ;CARRY OUT OF MS BYTE IS 
                        AN ERROR
FBAC FB7014           1491         ADDB   NBRLO    ;ADD 8X LS BYTE
FBAF B97013           1492         ADCA   NBRHI    ;ADD 8X MS BYTE
FBB2 2525             1493         BCS    CONERR   ;CARRY OUT OF MS BYTE IS 
                        AN ERROR
FBB4 F77014           1494         STAB   NBRLO    ;SAVE FINAL LS BYTE
FBB7 B77013           1495         STAA   NBRHI    ;SAVE FINAL MS BYTE
                      1496  
FBBA 20A4             1497         BRA    NUMLUP
                      1498  ;*****
                      1499  ;INPUT AN OCTAL NUMBER
FBBC C107             1500  OCTNUM CMPB   #$07
FBBE 2E19             1501         BGT    CONERR   ;NOT OCTAL IF > 7
                      1502  
                      1503  ;SHIFT HI & LO BYTES 2 PLACES LEFT - CARRY OUT O
 F HI BYTE IS ILLEGAL
FBC0 8D1D             1504         BSR    SHIFT2
FBC2 8D20             1505         BSR    SHIFT
                      1506  
FBC4 FA7014           1507         ORAB   NBRLO    ;ADD IN NEW DIGIT
FBC7 F77014           1508         STAB   NBRLO
                      1509  
FBCA 7EFB60           1510         JMP    NUMLUP
                      1511  
                      1512  ;*****
                      1513  ;GOT NUMBER - SCAN WAS SUCCESSFUL
                      1514  ;UPDATE GOOD SYNTAX LINE POINTER
FBCD FE700C           1515  GUDNUM LDX    LINPTR
FBD0 FF700A           1516         STX    SYNPTR
FBD3 FE70D2           1517         LDX    XTEMP2
FBD6 8601             1518         LDAA   #1       ;SET "GOOD SCAN" FLAG
FBD8 39               1519         RTS
                      1520  
                      1521  ;*****
                      1522  ;CONVERSION ERROR - SCAN WAS UNSUCCESSFUL
FBD9 FE70D2           1523  CONERR LDX    XTEMP2
FBDC 4F               1524         CLRA
FBDD 4A               1525         DECA
FBDE 39               1526         RTS
                      1527  ;----------------------------------
                      1528  ;SHIFT LEFT 2 POSITIONS
FBDF 8D03             1529  SHIFT2 BSR    SHIFT
FBE1 8D01             1530         BSR    SHIFT
FBE3 39               1531         RTS
                      1532  ;----------------------------------
                      1533  ;SHIFT A TWO BYTE NUMBER LEFT ONE POSITION
FBE4 787014           1534  SHIFT  ASL    NBRLO
FBE7 797013           1535         ROL    NBRHI
FBEA 2501             1536         BCS    SHFTER
FBEC 39               1537         RTS
                      1538  ;ERROR - HI ORDER BYTE OVERFLOW
                      1539  ;ABORT NUMBER ROUTINE DIRECTLY THRU STACK ADJ. &
 A JUMP
FBED 31               1540  SHFTER INS
FBEE 31               1541         INS
FBEF 20E8             1542         BRA    CONERR
                      1543  
                      1544  ;===============================================
 =======


Crasm 1.8:                           MONDEB                  page 30

                      1545  ;OUTPUT A SPACE
FBF1 8620             1546  OUTSP  LDAA   #$20
FBF3 BDFE76           1547         JSR    OUTCHR
FBF6 39               1548         RTS
                      1549  
                      1550  ;===============================================
 =======
                      1551  ;OUTPUT AN "=" SIGN
FBF7 863D             1552  OUTEQ  LDAA   #'='
FBF9 BDFE76           1553         JSR    OUTCHR
FBFC 39               1554         RTS
                      1555  
                      1556  ;===============================================
 =======
                      1557  ;OUTPUT A 1 BYTE NUMBER
                      1558  ;ACCA, ACCB, & IX ARE PRESERVED
FBFD 37               1559  OUT1BY PSHB
FBFE C601             1560         LDAB   #1
FC00 8D09             1561         BSR    OUTNUM
FC02 33               1562         PULB
FC03 39               1563         RTS
                      1564  
                      1565  ;===============================================
 =======
                      1566  ;OUTPUT A 2 BYTE NUMBER
                      1567  ;ACCA, ACCB, & IX ARE PRESERVED
FC04 37               1568  OUT2BY PSHB
FC05 C602             1569         LDAB   #2
FC07 8D02             1570         BSR    OUTNUM
FC09 33               1571         PULB
FC0A 39               1572         RTS
                      1573  
                      1574  ;===============================================
 =======
                      1575  ;DISPLAY THE NUMBER POINTED AT BY THE ADDRESS IN
 THE INDEX REGISTER
                      1576  ;AND OUTPUT IT ACCORDING TO THE BASE SPECIFIED I
 N "DBCODE"
                      1577  ;LEADING ZEROES ARE INCLUDED
                      1578  ;ACCA & IX ARE PRESERVED
                      1579  ;ACCB IS INPUT AS THE NUMBER OF BYTES COMPRISING
 THE NUMBER
                      1580  ;GLOBAL VARIABLES FOR EXTERNAL COMMUNICATION
                      1581  ;IBCODE - INPUT BASE CODE
                      1582  ;DBCODE - DISPLAY BASE CODE
                      1583  
                      1584  ;LOCAL VARIABLES
                      1585  ;DECDIG - DECIMAL DIGIT BEING BUILT
                      1586  ;NUMBHI - HI BYTE OF NUMBER BEING OUTPUT
                      1587  ;NUMBLO - LO BYTE OF NUMBER BEING OUTPUT
                      1588  
FC0B FF70D0           1589  OUTNUM STX    XTEMP1
FC0E 36               1590         PSHA
FC0F EE00             1591         LDX    ,X       ;GET THE TO BYTES AT THAT
                        ADDRESS
FC11 FF70DA           1592         STX    NUMBHI   ;PUT THEM IN A SCRATCH AR
                        EA FOR PROCESSING
FC14 B67011           1593         LDAA   DBCODE   ;GET DISPLAY BASE
                      1594  
FC17 8101             1595         CMPA   #1
FC19 270C             1596         BEQ    OUTHEX
FC1B 8102             1597         CMPA   #2


Crasm 1.8:                           MONDEB                  page 31

FC1D 271E             1598         BEQ    OUTDEC
FC1F 8103             1599         CMPA   #3
FC21 275E             1600         BEQ    OUTOCT
FC23 8104             1601         CMPA   #4
FC25 2778             1602         BEQ    OUTBIN
                      1603  
                      1604  ;*****
                      1605  ;OUTPUT A HEX NUMBER
FC27 58               1606  OUTHEX ASLB            ;1 BYTE=2 CHARS, 2 BYTES=
                        4 CHARS
                      1607  ;GET NEXT 4 BITS
FC28 BDFCB3           1608  DISNU1 JSR    LSH2
FC2B BDFCB3           1609         JSR    LSH2
                      1610  
FC2E 840F             1611         ANDA   #$F      ;EXTRACT 4 BITS
FC30 8109             1612         CMPA   #9
FC32 2F02             1613         BLE    DISNU2
FC34 8B07             1614         ADDA   #7       ;CONVERT 10:15 TO A:F
                      1615  
FC36 8D75             1616  DISNU2 BSR    OUTIT
FC38 5A               1617         DECB
FC39 26ED             1618         BNE    DISNU1
FC3B 2035             1619         BRA    OUTDE5
                      1620  
                      1621  ;*****
                      1622  ;OUTPUT A DECIMAL NUMBER
FC3D 5A               1623  OUTDEC DECB            ;TEST # OF BYTES TO OUTPU
                        T
FC3E 270B             1624         BEQ    OUTDE1
                      1625  ;INITIALIZE FOR OUTPUT OF A 2 BYTE NUMBER
FC40 CEFC77           1626         LDX    #C10K
FC43 B670DA           1627         LDAA   NUMBHI
FC46 F670DB           1628         LDAB   NUMBLO
FC49 2007             1629         BRA    OUTDE2
                      1630  
                      1631  ;INITIALIZE FOR OUTPUT OF A 1 BYTE NUMBER
FC4B CEFC7B           1632  OUTDE1 LDX    #C100
FC4E 4F               1633         CLRA
FC4F F670DA           1634         LDAB   NUMBHI
                      1635  
FC52 7F70D9           1636  OUTDE2 CLR    DECDIG   ;CLEAR THE DIGIT TO OUTPU
                        T
                      1637  
                      1638  ;SUBTRACT THE POWER OF 10 CONVERSION CONSTANT
FC55 E001             1639  OUTDE3 SUBB   1,X
FC57 A200             1640         SBCA   0,X
FC59 2505             1641         BCS    OUTDE4   ;TEST FOR BORROW (CARRY)
                      1642  
FC5B 7C70D9           1643         INC    DECDIG   ;NO BORROW YET - INC DIGI
                        T BEING BUILT
FC5E 20F5             1644         BRA    OUTDE3   ;REPEAT LOOP
                      1645  ;BORROW GENERATED - CANCEL LAST SUBTRACTION
FC60 EB01             1646  OUTDE4 ADDB   1,X
FC62 A900             1647         ADCA   0,X
                      1648  
                      1649  ;BUILDING OF DIGIT TO OUTPUT COMPLETE - PRINT IT
FC64 36               1650         PSHA            ;SAVE LO BYTE OF NUMBER B
                        EING OUTPUT
FC65 B670D9           1651         LDAA   DECDIG   ;GET DIGIT
FC68 8D43             1652         BSR    OUTIT    ;PRINT IT
FC6A 32               1653         PULA            ;RESTORE LO BYTE
                      1654  ;GET NEXT LOWER POWER OF 10


Crasm 1.8:                           MONDEB                  page 32

FC6B 08               1655         INX
FC6C 08               1656         INX
FC6D 8CFC81           1657         CPX    #C10K+10 ;ARE WE THRU WITH UNITS C
                        ONVERSION?
FC70 26E0             1658         BNE    OUTDE2   ;IF NOT, BACK TO GET NEXT
                        DIGIT
FC72 32               1659  OUTDE5 PULA            ;IF YES, RESTORE REGISTER
                        S & RETURN
FC73 FE70D0           1660         LDX    XTEMP1
FC76 39               1661         RTS
                      1662  
                      1663  ;DECIMAL OUTPUT CONVERSION CONSTANTS
FC77 2710             1664  C10K   DW     10000
FC79 03E8             1665         DW     1000
FC7B 0064             1666  C100   DW     100
FC7D 000A             1667         DW     10
FC7F 0001             1668         DW     1
                      1669  
                      1670  ;*****
                      1671  ;OUTPUT AN OCTAL NUMBER
                      1672  ;FIRST DIGIT IS A ONE OR A ZERO
FC81 58               1673  OUTOCT ASLB            ;FIRST APPROXIMATION OF #
                        OF DIGITS TO OUTPUT
FC82 4F               1674         CLRA
FC83 C102             1675         CMPB   #2
FC85 2E06             1676         BGT    OUTOC1
FC87 8D2A             1677         BSR    LSH2     ;1 BYTE - GET FIRST 2 BIT
                        S
FC89 8D22             1678         BSR    OUTIT
FC8B 2005             1679         BRA    DISNU3   ;GO OUTPUT LAST 2 DIGITS
                      1680  ;TWO BYTE # - OUTPUT HI ORDER BIT/DIGIT
FC8D 8D29             1681  OUTOC1 BSR    LEFSHF
FC8F 8D1C             1682         BSR    OUTIT
FC91 5C               1683         INCB           ;5 MORE DIGITS TO GO
                      1684  ;GET NEXT 3 BITS
FC92 8D1F             1685  DISNU3 BSR    LSH2
FC94 8D22             1686         BSR    LEFSHF
                      1687  
FC96 8407             1688         ANDA   #7      ;EXTRACT 3 BITS
FC98 8D13             1689         BSR    OUTIT
FC9A 5A               1690         DECB           ;COUNT THIS DIGIT
FC9B 26F5             1691         BNE    DISNU3  ;ARE WE DONE?
FC9D 20D3             1692         BRA    OUTDE5  ;YES
                      1693  ;*****
                      1694  ;OUTPUT A BINARY NUMBER
FC9F 58               1695  OUTBIN ASLB
FCA0 58               1696         ASLB
FCA1 58               1697         ASLB
                      1698  ;GET NEXT BIT
FCA2 8D14             1699  DISNU4 BSR    LEFSHF
FCA4 8401             1700         ANDA   #1       ;EXTRACT THE BIT
                      1701  
FCA6 8D05             1702         BSR    OUTIT    ;OUTPUT IT
FCA8 5A               1703         DECB            ;COUNT IT
FCA9 26F7             1704         BNE    DISNU4   ;ARE WE DONE?
FCAB 20C5             1705         BRA    OUTDE5   ;YES
                      1706  
                      1707  ;**
                      1708  ;CONVERT TO A NUMERIC ASCII DIGIT & OUTPUT IT
FCAD 8B30             1709  OUTIT  ADDA   #$30
FCAF BDFE76           1710         JSR    OUTCHR
FCB2 39               1711         RTS


Crasm 1.8:                           MONDEB                  page 33

                      1712  ;**
                      1713  ;LEFT SHIFT 2 BITS
FCB3 8D03             1714  LSH2   BSR    LEFSHF
FCB5 8D01             1715         BSR    LEFSHF
FCB7 39               1716         RTS
                      1717  
                      1718  ;**
                      1719  ;LEFT SHIFT THE 3 BYTE NUMBER 1 BIT
FCB8 7870DB           1720  LEFSHF ASL    NUMBLO
FCBB 7970DA           1721         ROL    NUMBHI
FCBE 49               1722         ROLA
FCBF 39               1723         RTS
                      1724  
                      1725  ;===============================================
 =======
                      1726  ;THIS ROUTINE GETS THE NEXT CHARACTER FROM THE I
 NPUT LINE BUFFER
                      1727  ;ACCA IS PRESERVED
                      1728  ;ACCB IS LOADED WITH THE CHARACTER
                      1729  ;IX IS INCREMENTED & LEFT POINTING TO THE CHARAC
 TER RETURNED
FCC0 FE700C           1730  GETCHR LDX    LINPTR
FCC3 08               1731         INX
FCC4 E600             1732         LDAB   ,X
FCC6 FF700C           1733         STX    LINPTR
FCC9 7F700E           1734         CLR    BOLFLG   ;SET FLAG TO NOT AT "BEGI
                        NNING OF LINE"
FCCC 39               1735         RTS
                      1736  
                      1737  ;===============================================
 =======
                      1738  ;THIS ROUTINE GETS THE NEXT CHARACTER IN THE COM
 MAND LISTS
                      1739  ;ACCA IS THE CHARACTER RETRIEVED
                      1740  ;ACCB IS PRESERVED
                      1741  ;IX IS INCREMENTED & LEFT POINTING TO THE CHARAC
 TER RETURNED
FCCD FE70D7           1742  GETLST LDX    LISPTR   ;GET CURRENT LIST POINTER
FCD0 08               1743         INX             ;MOVE POINTER TO NEXT CHA
                        R
FCD1 A600             1744         LDAA   ,X       ;GET CHARACTER POINTED AT
FCD3 FF70D7           1745         STX    LISPTR   ;SAVE POINTER
FCD6 39               1746         RTS             ;AND RETURN
                      1747  
                      1748  ;===============================================
 =======
                      1749  ; COMMAND LISTS
                      1750  ;  A CARRIAGE RETURN SIGNIFIES END-OF-COMMAND
                      1751  ;  A LINE FEED SIGNIFIES END-OF-COMMAND-LST
                      1752  ;LIST 1 - MAJOR COMMANDS
  FCD7                1753  COMLST EQU    *
FCD7 524547           1754         ASC    "REG"    ; DISPLAY REGISTERS
FCDA 0D               1755         DB     CR
FCDB 474F544F         1756         ASC    "GOTO"   ;GO TO MEMORY ADDRESS
FCDF 0D               1757         DB     CR
FCE0 534549           1758         ASC    "SEI"    ;SET INTERRUPT MASK
FCE3 0D               1759         DB     CR
FCE4 434C49           1760         ASC    "CLI"    ; CLEAR INTERRUPT MAST
FCE7 0D               1761         DB     CR
FCE8 434F5059         1762         ASC    "COPY"   ;COPY FROM ONE LOCATION T
                        O ANOTHER
FCEC 0D               1763         DB     CR


Crasm 1.8:                           MONDEB                  page 34

FCED 425245414B       1764         ASC    "BREAK"  ;SET BREAKPOINT (SWI CODE
                        )
FCF2 0D               1765         DB     CR
FCF3 4942415345       1766         ASC    "IBASE"  ;SET INPUT BASE
FCF8 0D               1767         DB     CR
FCF9 4442415345       1768         ASC    "DBASE"  ;SET DISPLAY BASE
FCFE 0D               1769         DB     CR
FCFF 434F4E54494E55
FD06 45               1770         ASC    "CONTINUE" ;CONTINUE FROM "SWI"
FD07 0D               1771         DB     CR
FD08 444953504C4159   1772         ASC    "DISPLAY" ;DISPLAY MEMORY DATA
FD0F 0D               1773         DB     CR
FD10 534554           1774         ASC    "SET"    ;SET MEMORY DATA
FD13 0D               1775         DB     CR
FD14 564552494659     1776         ASC    "VERIFY" ;VERIFY THAT MEMORY CONTE
                        NT IS UNCHANGED
FD1A 0D               1777         DB     CR
FD1B 534541524348     1778         ASC    "SEARCH" ;SEARCH MEMORY FOR A BYTE
                        STRING
FD21 0D               1779         DB     CR
FD22 54455354         1780         ASC    "TEST"   ;TEST A RANGE OF MEMORY
FD26 0D               1781         DB     CR
FD27 494E54           1782         ASC    "INT"    ;SET INTERRUPT POINTER
FD2A 0D               1783         DB     CR
FD2B 4E4D49           1784         ASC    "NMI"    ;SET NON-MASKABLE INTERRU
                        PT POINTER
FD2E 0D               1785         DB     CR
FD2F 535749           1786         ASC    "SWI"    ;SET SOFTWARE INTERRUPT P
                        OINTER
FD32 0D               1787         DB     CR
FD33 434F4D50415245   1788         ASC    "COMPARE" ;PRINT SUM & DIFFERENCE 
                         OF 2 NUMBERS
FD3A 0D               1789         DB     CR
FD3B 44554D50         1790         ASC    "DUMP"   ;DUMP MEMORY IN MIKBUG OR
                        IMAGE FORMAT
FD3F 0D               1791         DB     CR
FD40 4C4F4144         1792         ASC    "LOAD"   ;LOAD MIKBUG TAPE
FD44 0D               1793         DB     CR
FD45 44454C4159       1794         ASC    "DELAY"  ;DELAY SPECIFIED # OF MSE
                        CS
FD4A 0D               1795         DB     CR
FD4B 0A               1796         DB     LF       ;END OF LIST 1
                      1797  
                      1798  ;LIST 2 - MODIFIER TO DUMP
FD4C 544F             1799         ASC    "TO"     ;DESTINATION ACIA
FD4E 0D               1800         DB     CR
FD4F 0A               1801         DB     LF       ;END OF LIST 2
                      1802  
                      1803  ;LIST 3 - NUMBER BASE SPECIFIERS
FD50 484558           1804         ASC    "HEX"    ;BASE 16
FD53 0D               1805         DB     CR
FD54 444543           1806         ASC    "DEC"    ;BASE 10
FD57 0D               1807         DB     CR
FD58 4F4354           1808         ASC    "OCT"    ;BASE 8
FD5B 0D               1809         DB     CR
FD5C 42494E           1810         ASC    "BIN"    ;BASE 2
FD5F 0D               1811         DB     CR
FD60 0A               1812         DB     LF       ;END OF LIST 3
                      1813  
                      1814  ;LIST 4 - INFORMATION REQUEST
FD61 3F               1815         ASC    "?"
FD62 0D               1816         DB     CR


Crasm 1.8:                           MONDEB                  page 35

FD63 0A               1817         DB     LF       ; END OF LIST 4
                      1818  
                      1819  ;LIST 5 - REGISTER NAMES
FD64 2E4343           1820         ASC    ".CC"
FD67 0D               1821         DB     CR
FD68 2E42             1822         ASC    ".B"
FD6A 0D               1823         DB     CR
FD6B 2E41             1824         ASC    ".A"
FD6D 0D               1825         DB     CR
FD6E 2E4958           1826         ASC    ".IX"
FD71 0D               1827         DB     CR
FD72 2E5043           1828         ASC    ".PC"
FD75 0D               1829         DB     CR
FD76 2E5350           1830         ASC    ".SP"
FD79 0D               1831         DB     CR
FD7A 0A               1832         DB     LF       ;END OF LIST 5
                      1833  
                      1834  ;LIST 6 - MODIFIERS TO "DISPLAY"
FD7B 44415441         1835         ASC    "DATA"
FD7F 0D               1836         DB     CR
FD80 55534544         1837         ASC    "USED"
FD84 0D               1838         DB     CR
FD85 0A               1839         DB     LF       ;END OF LIST 6
                      1840  
                      1841  ;LIST 7 - MODIFIER TO "LOAD"
FD86 46524F4D         1842         ASC    "FROM"   ;SOURCE ACIA
FD8A 0D               1843         DB     CR
FD8B 0A               1844         DB     LF       ;END OF LIST 7
                      1845  ;===============================================
 =======
                      1846  
                      1847  ; THIS ROUTINE CONSTRUCTS A LINE OF INPUT BY GET
  TING ALL INPUT
                      1848  ; CHARACTERS UP TO AND INCLUDING A CARRIAGE RETU
  RN (WHICH THEN
                      1849  ; DESIGNATES "END OF LINE").
                      1850  ; TYPING RUBOUT WILL DELETE THE PREVIOUS CHARACT
  ER
                      1851  ; TYPING CONTROL-C WILL ABORT THE LINE
                      1852  ; TYPING CONTROL-Z WILL USE THE PREVIOUS LINE
                      1853  ; THE INPUT LINE IS STORED BEGINNING AT THE ADDR
  ESS STORED IN BUFBEG
                      1854  ; AND ENDING AT THE ADDRESS STORED IN BUFEND
                      1855  ;ACCA, ACCB, & IX ARE NOT PRESERVED
                      1856  ;
                      1857  ;GLOBAL VARIABLES
                      1858  ;BUFBEG - INPUT LINE START OF BUFFER
                      1859  ;BUFEND - INPUT LINE END OF BUFFER
                      1860  
                      1861  ;LOCAL CONSTANTS
  005C                1862  BAKSLA EQU    92       ;A BACKSLASH
  007F                1863  DELETE EQU    127      ;CODE TO DELETE THE PREVI
                        OUS CHARACTER
                      1864  ;
                      1865  ;
                      1866  ;*** ROUTINE ENTRY POINT
                      1867  
FD8C FE702C           1868  GETLIN LDX    BUFBEG   ;SET POINTER TO ONE LESS 
                        THAN THE BEGINNING OF THE LINE BUFFER
FD8F 5F               1869         CLRB            ;ACCB HOLS THE LAST INPUT
                        CHAR
                      1870  


Crasm 1.8:                           MONDEB                  page 36

FD90 BC702E           1871  NXTCHR CPX    BUFEND   ;CHECK CURRENT LINE END A
                        GAINST BUFFER END
FD93 2609             1872         BNE    GETIT
                      1873  
                      1874  ;LINE TOO LONG - ABORT IT AS IF A CONTROL-C HAD 
 BEEN TYPED
FD95 CEFF07           1875         LDX    #MSGLTL  ;GET MESSAGE
FD98 BDFE4B           1876         JSR    OUTSTR   ;OUTPUT IT
FD9B C603             1877         LDAB   #3       ;PUT CTL-C IN ACCB
FD9D 39               1878         RTS
                      1879  
FD9E BDFE59           1880  GETIT  JSR    INPCHR   ;GET A CHARACTER (RETURNE
                        D IN ACCA)
FDA1 847F             1881         ANDA   #127     ;DROP PARITY BIT
                      1882  
                      1883  ;CONTROL-Z COPIES FROM PRESENT POSITION TO PREVI
 OUS END OF LINE
FDA3 811A             1884         CMPA   #26      ;IS CHAR A CONTROL-A?
FDA5 2604             1885         BNE    TSTCR
FDA7 BDFEC7           1886         JSR    DOCRLF   ;YES, TYPE CR-LF
FDAA 39               1887         RTS
FDAB 810D             1888  TSTCR  CMPA   #13      ;IS CHAR A CR?
FDAD 2704             1889         BEQ    TSTCR1
FDAF 810A             1890         CMPA   #10      ;OR A LF?
FDB1 260C             1891         BNE    NOTEOL
FDB3 08               1892  TSTCR1 INX
FDB4 A700             1893         STAA   ,X       ;YES, STORE THE TERMINATO
                        R
FDB6 7D7029           1894         TST    HDXFLG   ;TEST FOR HALF-DUPLEX TER
                        MINAL
FDB9 2603             1895         BNE    TSTCR2
FDBB BDFEC7           1896         JSR    DOCRLF   ;TYPE CR-LF
FDBE 39               1897  TSTCR2 RTS             ;NOW RETURN
                      1898  
FDBF 8103             1899  NOTEOL CMPA   #3       ;IS CHAR A CONTROL-C?
FDC1 2607             1900         BNE    NOTCTC
                      1901  ;ECHO AN UP-ARROW
FDC3 16               1902         TAB             ;RETURN CONTROL-C IN ACCB
FDC4 865E             1903         LDAA   #'^'
FDC6 BDFE76           1904         JSR    OUTCHR
FDC9 39               1905         RTS
                      1906  
FDCA 817F             1907  NOTCTC CMPA   #DELETE  ;NO, IS IT DELETE
FDCC 2725             1908         BEQ    RUBNOW   ;IF YES, GO TO RUBNOW
                      1909  
                      1910  ;CONVERT LOWER CASE TO UPPER CASE
FDCE 8160             1911         CMPA   #$60     ;BELOW L.C. A?
FDD0 2306             1912         BLS    STORIT
FDD2 817A             1913         CMPA   #$7A     ;ABOVE L.C. Z?
FDD4 2202             1914         BHI    STORIT
FDD6 8020             1915         SUBA   #32      ;CONVERT L.C. ALPHABETIC 
                        TO U.C.
                      1916  
FDD8 08               1917  STORIT INX             ;NOT A DELETE, SO ADVANCE
                        TO NEXT CHARACTER
FDD9 A700             1918         STAA   ,X       ;STORE IT IN INPLIN
                      1919  
FDDB C17F             1920         CMPB   #DELETE  ;IS LAST CHAR A DELETE?
FDDD 2703             1921         BEQ    OUTBAK   ;IF SO. GO TO OUTBAK
FDDF 16               1922         TAB             ;ITS NOT, UPDATE LAST CHA
                        R
FDE0 2007             1923         BRA    ECHO     ;GO ECHO IT


Crasm 1.8:                           MONDEB                  page 37

                      1924  
                      1925  ;LAST CHAR WAS A DELETE, BUT THIS ONE ISN'T
FDE2 16               1926  OUTBAK TAB             ;UPDATE LAST CHAR
FDE3 865C             1927         LDAA   #BAKSLA  ;PRINT A -
FDE5 BDFE76           1928         JSR    OUTCHR   ;BACKSLASH
FDE8 17               1929         TBA             ;RESTORE CURRENT CHAR FOR
                        ECHO
FDE9 7D7029           1930  ECHO   TST    HDXFLG   ;TEST FOR HALF DUPLEX TER
                        MINAL
FDEC 2603             1931         BNE    ECHO1
FDEE BDFE76           1932         JSR    OUTCHR   ;NOW ECHO IT
FDF1 209D             1933  ECHO1  BRA    NXTCHR   ;GET ANOTHER
                      1934  ;
                      1935  ; CURRENT CHARACTER IS A DELETE
                      1936  ; TEST LINE LENGTH - IT ITS ZERO, IGNORE THIS DE
  LETE SINCE
                      1937  ; WE CAN'T DELETE PRIOR TO FIRST CHARACTER IN IN
  PUT LINE
FDF3 BC702C           1938  RUBNOW CPX    BUFBEG
FDF6 2798             1939         BEQ    NXTCHR
FDF8 C17F             1940         CMPB   #DELETE  ;WAS LAST CHAR A DELETE?
FDFA 2706             1941         BEQ    LASWAS
                      1942  
                      1943  ;LAST CHAR WASN'T A DELETE
FDFC 16               1944        TAB              ;UPDATE LAST CHAR (WITH A
                        DELETE)
FDFD 865C             1945        LDAA    #BAKSLA  ;PRINT A -
FDFF BDFE76           1946        JSR     OUTCHR   ;BACKSLASH
                      1947  ;LAST CHAR WAS A DELETE
FE02 A600             1948  LASWAS LDAA   ,X       ;GET THE CHAR TO BE DELET
                        ED
FE04 09               1949         DEX             ;DECREMENT LINE POINTER
FE05 20E2             1950         BRA    ECHO     ;ECHO DELETED CHARACTER
                      1951  
                      1952  ;===============================================
 =======
                      1953  ;INITIALIZATION ROUTINE
                      1954  ;DISABLE INTERRUPTS
FE07 0F               1955         SEI
FE08 8601             1956  INITAL LDAA   #1
FE0A B77010           1957         STAA   IBCODE   ;SET INPUT BASE TO HEX
FE0D B77011           1958         STAA   DBCODE   ;SET DISPLAY BASE TO HEX
                      1959  ;SET UP DISPLAY BASE NUMBER
FE10 8610             1960         LDAA   #16
FE12 B77012           1961         STAA   DBNBR
                      1962  ;MAX # OF CHARACTERS PER LINE
FE15 8648             1963         LDAA   #72
FE17 B7702B           1964         STAA   CPLMAX
FE1A 7F7023           1965         CLR    INPFLG   ;DEFAULT INPUT FROM THE T
                        ERMINAL
FE1D 7F7026           1966         CLR    OUTFLG   ;DEFAULT OUTPUT TO THE TE
                        RMINAL
FE20 7F7029           1967         CLR    HDXFLG   ;CLEAR HALF-DUPLEX FLAG
                      1968  ;INITIALIZE ACIA1 & ACIA2 TO 7 BITS AND EVEN PAR
 ITY
                      1969  ;RESET BOTH
FE23 8603             1970         LDAA   #3
FE25 B77F42           1971         STAA   ACIA1-1
FE28 B77F44           1972         STAA   ACIA2-1
                      1973  ;SET EM UP
FE2B 8602             1974         LDAA   #2
FE2D B77F42           1975         STAA   ACIA1-1


Crasm 1.8:                           MONDEB                  page 38

FE30 B77F44           1976         STAA   ACIA2-1
                      1977  ;SET UP SWI INTERRUPT ADDRESS POINTER
FE33 CEF501           1978         LDX    #TYPSWI  ;TYPE "SWI" & DO "REG" CO
                        MMAND
FE36 FF7004           1979         STX    SWIVEC
                      1980  ;INITIALIZE TO MONDEB'S COMMAND LISTS
FE39 CEFCD6           1981         LDX    #COMLST-1
FE3C FF7008           1982         STX    COMADR
                      1983  ;TIME CONSTANT FOR A 2 MICROSECOND CLOCK
FE3F 8653             1984         LDAA   #83
FE41 B770DE           1985         STAA   TIMCON
                      1986  ;ALLOW TIME FOR TTY MOTOR TO COME UP TO SPEED
FE44 CE01F4           1987         LDX    #500
FE47 BDF9BD           1988         JSR    TIMDEL
FE4A 39               1989         RTS
                      1990  
                      1991  ;===============================================
 =======
                      1992  ;OUTPUT A CHARACTER STRING WHICH BEGINS AT THE A
 DDRESS IN THE INDEX REGISTER
                      1993  ;ACCA & ACCB ARE PRESERVED
                      1994  ;IX IS LEFT POINTING TO THE STRING TERMINATOR
FE4B 36               1995  OUTSTR PSHA
FE4C A600             1996  OUTST1 LDAA   ,X       ;GET CHAR POINTED TO
FE4E 8104             1997         CMPA   #4       ;IS IT A STRING TERMINATO
                        R?
FE50 2705             1998         BEQ    OUTEND   ;DONE IF IT IS
FE52 8D22             1999         BSR    OUTCHR   ;ISN'T, OUTPUT IT
FE54 08               2000         INX             ;ON TO NEXT CHARACTER
FE55 20F5             2001         BRA    OUTST1
FE57 32               2002  OUTEND PULA
FE58 39               2003         RTS             ;RETURN
                      2004  
                      2005  ;===============================================
 =======
                      2006  ;INPUT A CHARACTER FROM AN ACIA TO ACCA
                      2007  ;IF INPFLG = 0, INPUT IS FROM TERMINAL ACIA
                      2008  ;IF INPFLG = 0, INPUT IS FROM ANY ACIA
                      2009  ;ACCB & IX ARE PRESERVED
                      2010  
FE59 FF70CE           2011  INPCHR STX    XTEMP    ;SAVE IX
FE5C 7D7023           2012         TST    INPFLG   ;TEST INPUT SOURCE FLAG
FE5F 2605             2013         BNE    INPCH1
                      2014  ;INPFLG=0: INPUT FROM TERMINAL ACIA
FE61 CE7F43           2015         LDX    #ACIA1
FE64 2003             2016         BRA    INPCH2
                      2017  ;INPFLG=1: INPUT FROM ANY ACIA
FE66 FE7024           2018  INPCH1 LDX    INPADR   ;GET ITS ADDRESS
FE69 09               2019  INPCH2 DEX             ;POINT TO CONTROL REG
FE6A A600             2020  INPCH3 LDAA   ,X       ;GET ACIA STATUS BYTE
FE6C 8501             2021         BITA   #1       ;CHAR WAITING?
FE6E 27FA             2022         BEQ    INPCH3   ;IF NOT, TRY AGAIN
FE70 A601             2023         LDAA   1,X      ;YES, GET IT
FE72 FE70CE           2024         LDX    XTEMP    ;RESTORE IX
FE75 39               2025         RTS
                      2026  
                      2027  ;===============================================
 =======
                      2028  ;OUTPUT THE CHARACTER IN ACCA TO THE DESIRED OUT
 PUT DEVICE/LOCATION
                      2029  ; IF OUTFLG = 0, OUTPUT IS TO TERMINAL
                      2030  ; IF OUTFLG = 1, OUTPUT IS TO ACIA ADDRESS STORE


Crasm 1.8:                           MONDEB                  page 39

  D IN OUTADR
                      2031  ; IF OUTFLG = 2, OUTPUT IS TO ADDRESS IN OUTADR 
  & THIS ADDR IS THEN INCREMENTED
                      2032  ;ACCA, ACCB, & IX ARE PRESERVED
FE76 37               2033  OUTCHR PSHB            ;SAVE ACCB
FE77 7D7026           2034         TST    OUTFLG   ;TEST OUTPUT DESTINATION 
                        FLAG
FE7A 2721             2035         BEQ    OUTCH4   ;SKIP THIS CODE IF TERMIN
                        AL OUTPUT
                      2036  
                      2037  ;OUTPUT TO SOMETHING OTHER THAN THE TERMINAL
FE7C FF70CE           2038        STX     XTEMP    ;SAVE IX
FE7F FE7027           2039        LDX     OUTADR   ;GET OUTPUT CHAR DESTINAT
                        ION ADDRESS
FE82 C602             2040        LDAB    #2
FE84 F17026           2041        CMPB    OUTFLG
FE87 2709             2042        BEQ     OUTCH2
                      2043  
                      2044  ;OUTFLG = 1: ANY ACIA OUTPUT
FE89 09               2045         DEX             ;POINT TO ACIA STATUS REG
FE8A E500             2046  OUTCH1 BITB   ,X       ;TEST TDRE BIT
FE8C 27FC             2047         BEQ    OUTCH1   ;LOOP IF NOT READY TO ACC
                        EPT A NEW CHAR
FE8E A701             2048         STAA   1,X      ;NOW READY - SEND IT
FE90 2006             2049         BRA    OUTCH3
                      2050  
                      2051  ;OUTCLF = 2: MEMORY OUTPUT
FE92 A700             2052  OUTCH2 STAA   ,X       ;SAVE CHAR IN MEMORY
FE94 08               2053         INX
FE95 FF7027           2054         STX    OUTADR   ; UPDATE OUTPUT ADDRESS
                      2055  
FE98 FE70CE           2056  OUTCH3 LDX    XTEMP    ;RESTORE IX
FE9B 33               2057         PULB            ;RESTORE ACCB
FE9C 39               2058         RTS
                      2059  
                      2060  ;OUTFLG = 0: TERMINAL ACIA OUTPUT
                      2061  ;IGNORE LINE FEEDS
FE9D 810A             2062  OUTCH4 CMPA   #LF
FE9F 2602             2063         BNE    OUTCH5
FEA1 33               2064         PULB
FEA2 39               2065         RTS
                      2066  
FEA3 810D             2067  OUTCH5 CMPA   #CR      ;TEST FOR CARRIAGE RETURN
FEA5 2604             2068         BNE    OUTCH6
FEA7 8D1E             2069         BSR    DOCRLF
FEA9 33               2070         PULB
FEAA 39               2071         RTS
                      2072  
FEAB F6702A           2073  OUTCH6 LDAB   CPLCNT   ;GET "CHARACTERS PER LINE
                        " COUNT
FEAE F1702B           2074         CMPB   CPLMAX   ;COMPARE TO MAX PERMISSIB
                        LE
FEB1 2C0B             2075         BGE    OUTCH7   ;SEND CR-LF IF GREATER
                      2076  ;LESS THAN MAX, BUT ALSO SEND CR-LF IF 10 FROM E
 ND AND PRINTING A SPACE
FEB3 CB0A             2077         ADDB   #10
FEB5 F1702B           2078         CMPB   CPLMAX
FEB8 2D06             2079         BLT    OUTCH8
FEBA 8120             2080         CMPA   #$20     ;NEAR END, TEST IF ABOUT 
                        TO PRINT A SPACE
FEBC 2602             2081         BNE    OUTCH8
                      2082  


Crasm 1.8:                           MONDEB                  page 40

                      2083  ;TERMINAL LINE FULL OR NEARLY FULL - INTERJECT A
 CR-LF
FEBE 8D07             2084  OUTCH7 BSR    DOCRLF
FEC0 7C702A           2085  OUTCH8 INC    CPLCNT   ;BUMP COUNTER
FEC3 8D20             2086         BSR    TOACIA   ;SEND IT TO ACIA1
FEC5 33               2087         PULB
FEC6 39               2088         RTS
                      2089  
                      2090  ;===============================================
 =======
                      2091  ;SEND A CARRIAGE RETURN-LINE FEED TO THE TERMINA
 L
                      2092  ;ACCA, ACCB, & IX ARE PRESERVED
FEC7 36               2093  DOCRLF PSHA
FEC8 37               2094         PSHB
FEC9 860D             2095         LDAA   #CR
FECB 8D18             2096         BSR    TOACIA
FECD 860A             2097         LDAA   #LF
FECF 8D14             2098         BSR    TOACIA
                      2099  
                      2100  ;ALLOW TIMER FOR THE CARRIAGE TO RETURN BY SENDI
 NG NULL CHARACTERS
                      2101  ;SEND 1 NULL PER 16 CHARACTERS
                      2102  ;DIVIDE CPLCNT BY 16
FED1 F6702A           2103         LDAB   CPLCNT
FED4 54               2104         LSRB
FED5 54               2105         LSRB
FED6 54               2106         LSRB
FED7 54               2107         LSRB
FED8 5C               2108         INCB            ;ALWAYS SEND AT LEAST 1 N
                        ULL
FED9 4F               2109  DOCRL1 CLRA            ;GET A NULL
FEDA 8D09             2110         BSR    TOACIA   ;SEND IT
FEDC 5A               2111         DECB
FEDD 26FA             2112         BNE    DOCRL1
FEDF 7F702A           2113         CLR    CPLCNT   ;ZERO "CHARACTERS PER LIN
                        E" COUNT
FEE2 33               2114         PULB
FEE3 32               2115         PULA
FEE4 39               2116         RTS
                      2117  
                      2118  ;===============================================
 =======
                      2119  ;PUT CHAR IN ACCA INTO TERMINAL ACIA
                      2120  ;ACCA, ACCB, & IX ARE PRESERVED
FEE5 36               2121  TOACIA PSHA            ;SAVE CHAR
FEE6 8602             2122         LDAA   #2       ;GET ACIA TRANSMIT REG ST
                        ATUS BIT
FEE8 B57F42           2123  TOACI1 BITA   ACIA1-1  ;REGISTER EMPTY?
FEEB 27FB             2124         BEQ    TOACI1   ;IF NOT, LOOP BACK
FEED 32               2125         PULA            ;YES, RESTORE CHARACTER
FEEE B77F43           2126         STAA   ACIA1    ;SEND IT
FEF1 39               2127         RTS
                      2128  
                      2129  ;===============================================
 =======
                      2130  ;MISC TEST
FEF2 4D4F4E44454220
FEF9 312E3030         2131  MSGHED ASC    "MONDEB 1.00" ;MONITOR HEADER TYPE
                             OUT
FEFD 0D04             2132         DB     CR,4
                      2133  


Crasm 1.8:                           MONDEB                  page 41

FEFF 2A04             2134  MSGPRM DB     '*',4    ;PROMPT STRING
                      2135  
FF01 0D               2136  MSGSWI DB     CR
FF02 5357493A         2137         ASC    "SWI:"
FF06 04               2138         DB     4
                      2139  
FF07 544F4F204C4F4E
FF0E 47               2140  MSGLTL ASC    "TOO LONG" ; TYPED IF INPUT LINE I
                           S TOO LONG
FF0F 04               2141         DB     4
                      2142  
FF10 4E4F5420534554   2143  MSGNBR ASC    "NOT SET" ; BREAK NOT SET
FF17 04               2144         DB     4
                      2145  
FF18 534554204020     2146  MSGBAT ASC    "SET @ " ; BREAK AT -
FF1E 04               2147         DB     4
                      2148  
FF1F 4F4B             2149  MSGVER ASC    "OK"     ;CHECKSUM VERIFIES
FF21 04               2150         DB     4
                      2151  
FF22 434845434B5355
FF29 4D204552524F52
FF30 20               2152  MSGNVE ASC    "CHECKSUM ERROR " ; FOR VERIFY & L
                                  OAD COMMANDS
FF31 04               2153         DB     4
                      2154  
FF32 43414E5420434C
FF39 454152           2155  MSGCCL ASC    "CANT CLEAR" ; TEST COMMAND
FF3C 04               2156         DB     4
                      2157  
FF3D 43414E54205345
FF44 5420544F204F4E
FF4B 4553             2158  MSGCSO ASC    "CANT SET TO ONES" ; TEST COMMAND
FF4D 04               2159         DB     4
                      2160  
FF4E 53554D20495320   2161  MSGSIS ASC    "SUM IS " ; COMPARE COMMAND
FF55 04               2162         DB     4
                      2163  
FF56 2C204449462049
FF5D 5320             2164  MSGDIS ASC    ", DIF IS " ; COMPARE COMMAND
FF5F 04               2165         DB     4
                      2166  
FF60 0D0A00           2167  MSGS0  DB     CR,LF,0
FF63 53303036303030
FF6A 30343834343532
FF71 3142             2168         ASC    "S00600004844521B"
FF73 04               2169         DB     4
                      2170  
FF74 0D0A0000533104   2171  MSGS1  DB     CR,LF,0,0,'S','1',4
                      2172  
FF7B 0D0A00           2173  MSGS9  DB     CR,LF,0
FF7E 53393033303030
FF85 304643           2174         ASC    "S9030000FC"
FF88 0D0A04           2175         DB     CR,LF,4
                      2176  
FF8B 43484152204E4F
FF92 5420484558       2177  MSGCNH ASC    "CHAR NOT HEX" ;USE IN LOAD COMMAN
                              D
FF97 0D04             2178         DB     CR,4
                      2179  
                      2180  ;===============================================
 =======


Crasm 1.8:                           MONDEB                  page 42

                      2181  ;INTERRUPT HANDLING CODE
FF99 FE7000           2182  INTADR LDX    INTVEC
FF9C 6E00             2183         JMP    ,X
                      2184  ;*****
FF9E FE7002           2185  NMIADR LDX    NMIVEC
FFA1 6E00             2186         JMP    ,X
                      2187  ;*****
FFA3 7EF400           2188  RESADR JMP    START
                      2189  ;*****
FFA6 BF7006           2190  SWIADR STS    SP       ;SAVE STACK POINTER OF PR
                        OGRAM BEING DEBUGGED
FFA9 FE7004           2191         LDX    SWIVEC
FFAC 6E00             2192         JMP    ,X
                      2193  ;*****
                      2194  ;      RMB    START+$c00-8-63-* ;BLANK SPACE TO 
       INTERRUPT VECTORS
  FFB9                2195         * =    $FFB9    ;AS CALCULATED BY PREVIOU
                        S LINE
                      2196  ;***********************************************
 ***
                      2197  
FFB9 7EF9BD           2198         JMP    TIMDEL   ;TIME DELAY FOR # OF MS S
                        PECIFIED BY IX
FFBC 7EF757           2199         JMP    CKSUM    ;RETURN CHECKSUM OF AN AD
                        DRESS RANGE IN ACCA
FFBF 7EFCC0           2200         JMP    GETCHR   ;RETURN (IN ACCB) CHAR PO
                        INTED TO BY LINPTR
FFC2 7EFCCD           2201         JMP    GETLST   ;RETURN (IN ACCA) CHAR PO
                        INTED TO BY LISPTR
FFC5 7EFAFC           2202         JMP    GTRANG   ;PICK UP AN ADDRESS RANGE
                        IN RANGLO & RANGHI
FFC8 7EFB47           2203         JMP    NUMBER   ;PICK UP A NUMBER & RETUR
                        N IT IN NBRHI & NBRLO
FFCB 7EFA69           2204         JMP    SKPDLM   ;SKIP OVER INPUT LINE DEL
                        IMITERS
FFCE 7EFA94           2205         JMP    TSTDLM   ;TEST CHAR IN ACCB FOR A 
                        DELIMITER
FFD1 7EFA89           2206         JMP    TSTEOL   ;TEST CHAR IN ACCA FOR EN
                        D-OF-LINE
FFD4 7EF9C7           2207         JMP    COMAND   ;SEARCH SPECIFIED COMMAND
                        LIST FOR A COMMAND
FFD7 7EFA2E           2208         JMP    TYPCMD   ;TYPES OUT COMMAND NUMBER
                        "COMNUM" IN LIST ACCA
FFDA 7EFBFD           2209         JMP    OUT1BY   ;DISPLAY THE 1 BYTE NUMBE
                        R POINTED AT BY IX
FFDD 7EFC04           2210         JMP    OUT2BY   ;DISPLAY THE 2 BYTE NUMBE
                        R POINTED AT BY IX
FFE0 7EFD8C           2211         JMP    GETLIN   ;GET A LINE OF INPUT INTO
                        THE TTY BUFFER
FFE3 7EFE4B           2212         JMP    OUTSTR   ;OUTPUT CHAR STRING IX PO
                        INTS TO
FFE6 7EFEC7           2213         JMP    DOCRLF   ;SEND CR-LF WITH DELAY & 
                        ZERO LINE COUNT
FFE9 7EFE76           2214         JMP    OUTCHR   ;LIKE TOACIA, BUT WITH FO
                        LDING, CR DELAY, & LF INSERTION
FFEC 7EFEE5           2215         JMP    TOACIA   ;SEND ACCA TO ACIA1
FFEF 7EFE59           2216         JMP    INPCHR   ;GET A CHAR FROM AN ACIA 
                        & RETURN IT IN ACCA
FFF2 7EF425           2217         JMP    PROMPT   ;TO PROMPT FOR A NEW COMM
                        AND
FFF5 7EF400           2218         JMP    START    ;START OF MONDEB
                      2219  ;***********************************************


Crasm 1.8:                           MONDEB                  page 43

 ***
                      2220  ;INTERRUPT VECTORS
FFF8 FF99             2221         DW    INTADR    ;REGULAR INTERRUPT
FFFA FFA6             2222         DW    SWIADR    ;SOFTWARE INTERRUPT
FFFC FF9E             2223         DW    NMIADR    ;NON-MASKABLE INTERRUPT
FFFE FFA3             2224         DW    RESADR    ;RESET INTERRUPT
                      2225  
                      2226  ;***********************************************
 ***
                      2227  ;VARIABLES FOR INTER-ROUTINE COMMUNICATION
  7000                2228         * =    $7000
7000 0000             2229  INTVEC DS     2        ;INTERRUPT ADDRESS POINTE
                        R
7002 0000             2230  NMIVEC DS     2        ;NON-MASKABLE INTERRUPT A
                        DDRESS POINTER
7004 0000             2231  SWIVEC DS     2        ;SOFTWARE INTERRUPT ADDRE
                        SS POINTER
7006 0000             2232  SP     DS     2        ;SAVED STACK POINTER
7008 0000             2233  COMADR DS     2        ;ADDRESS OF BEGINNING OF 
                        COMMAND LISTS FOR COMMAND
700A 0000             2234  SYNPTR DS     2        ;INPUT LINE CHARACTER POI
                        NTER FOR GOOD SYNTAX
700C 0000             2235  LINPTR DS     2        ;INPUT LINE CHARACTER POI
                        NTER (CONTENT = OR > CONTENT OF SYNPTR)
700E 00               2236  BOLFLG DS     1        ;"BEGINNING OF LINE" FLAG
700F 00               2237  DELIM  DS     1        ;CHARACTER(S) PERMITTTED 
                        AS VALID COMMAND/MODIFIER DELIMITER
7010 00               2238  IBCODE DS     1        ;INPUT BASE (1=HEX, 2=DEC
                        , 3=OCT)
7011 00               2239  DBCODE DS     1        ;DISPLAY BASE (1=HEX, 2=D
                        EC, 3=OCT, 4=BIN)
7012 00               2240  DBNBR  DS     1        ;DISPLAY BASE NUMBER (E.G
                        ., 16,10M8M OR 2)
                      2241  
7013 00               2242  NBRHI  DS     1        ;MOST SIGNIFICANT BYTE OF
                        SCANNED NUMBER
7014 00               2243  NBRLO  DS     1        ;LEAST SIGNIFICANT BYTE O
                        F SCANNED NUMBER
                      2244  
7015 0000             2245  RANGLO DS     2        ;RANGE LOWER LIMIT PICKED
                        UP BY GTRANG
7017 0000             2246  RANGHI DS     2        ;RANGE UPPER LIMIT PICKED
                        UP BY GTRANG
                      2247  
7019 0000             2248  LASTGO DS     2        ;LAST SPECIFIED GOTO ADDR
                        ESS
                      2249  
701B 0000             2250  VERFRM DS     2        ;BEGINNING ADDRESS OF RAN
                        GE TO CHECKSUM VERIFY
701D 0000             2251  VERTO  DS     2        ;ENDING ADDRESS OF RANGE 
                        TO CHECKSUM VERIFY
                      2252  
701F 00               2253  CHKSUM DS     1        ;CHECKSUM OF RANGE GIVEN 
                        IN THE VERIFY COMMAND
                      2254  
7020 0000             2255  BRKADR DS     2        ;ADDRESS OF INSERTED BREA
                        KPOINT
7022 00               2256  BRKINS DS     1        ;INSTRUCTION WHICH SHOULD
                        BE THERE NORMALLY
                      2257  
7023 00               2258  INPFLG DS     1        ;ALTERNATE INPUT DESTINAT
                        ION FLAG


Crasm 1.8:                           MONDEB                  page 44

7024 0000             2259  INPADR DS     2        ;ALTERNATE ADDRESS THAT T
                        HE INPUT CHARACTERS ARE TO COME FROM
                      2260  
7026 00               2261  OUTFLG DS     1        ;ALTERNATE OUTPUT DESTINA
                        TION FLAG
7027 0000             2262  OUTADR DS     2        ;ALTERNATE ADDRESS THAT T
                        HE OUTPUT CHARACTERS ARE TO GO TO
                      2263  
7029 00               2264  HDXFLG DS     1        ;HALF-DUPLEX TERMINAL FLA
                        G (IF NON-ZERO, NO ECHO)
                      2265  
702A 00               2266  CPLCNT DS     1        ;"CHARACTERS PER LINE" CO
                        UNT
702B 00               2267  CPLMAX DS     1        ;"CHARACTERS PER LINE" MA
                        XIMUM
702C 0000             2268  BUFBEG DS     2        ;INPUT LINE START OF BUFF
                        ER
702E 0000             2269  BUFEND DS     2        ;INPUT LINE END OF BUFFER
7030 00000000000000
7037 00000000000000
703E 00000000000000   2270  TTYBUF DS     72       ;START OF INPUT LINE BUFF
                        ER
7078 00               2271  TTYEND DS     1        ;END OF INPUT LINE BUFFER
7079 00000000000000
7080 00000000000000
7087 00000000000000   2272         DS     56       ;MAIN STACK STORAGE
70B1 00000000000000   2273  STACK  DS     7        ;STACK STORAGE FOR RTI IN
                        STRUCTION
                      2274  
                      2275  ;TEMPORARY (LOCALLY USED) VARIABLES
70B8 0000             2276  TEMP1  DS     2        ;IN: MAIN
70BA 0000             2277  TEMP2  DS     2        ;IN: MAIN
70BC 0000             2278  TEMP3  DS     2        ;IN: FNDSTR,MAIN
70BE 0000             2279  TEMP4  DS     2        ;IN: MAIN
70C0 0000             2280  TEMP5  DS     2        ;IN: MAIN
70C2 0000             2281  TEMP6  DS     2        ;IN: MAIN
70C4 0000             2282  TEMP7  DS     2        ;IN: MAIN
70C6 0000             2283  TEMP8  DS     2        ;IN: MAIN
70C8 0000             2284  TEMP9  DS     2        ;IN: MAIN
70CA 0000             2285  TEMP10 DS     2        ;IN: MAIN
70CC 0000             2286  TEMP11 DS     2        ;IN: MAIN
                      2287  
                      2288  ;XTEMP IS NOT TO BE USED TO SAVE IX BETWEEN ROUT
 INES
70CE 0000             2289  XTEMP  DS     2        ;USED BY DUMP,TYPCMD,OUTN
                        UM
70D0 0000             2290  XTEMP1 DS     2        ;USED BY OUTNUM
70D2 0000             2291  XTEMP2 DS     2        ;USED BY NUMBER
70D4 00               2292  NUMMAT DS     1        ;USED IN COMMAND
70D5 00               2293  LISNUM DS     1        ;USED ON COMMAND
70D6 00               2294  COMNUM DS     1        ;USED IN COMMAND
70D7 0000             2295  LISPTR DS     2        ;USED IN COMMAND
70D9 00               2296  DECDIG DS     1        ;DECIMAL DIGIT BEING BUIL
                        T (DECIMAL OUTPUT BASE)
70DA 00               2297  NUMBHI DS     1        ;USED BY OUTNUM
70DB 00               2298  NUMBLO DS     1        ;USED BY OUTNUM
70DC 0000             2299  NBR2X  DS     2        ;USED BY NUMBER
70DE 0000             2300  TIMCON DS     2        ;DELAY TIME CONSTANT
70E0 00               2301  BYTECT DS     1        ;RECORD BYTE COUNT USED I
                        N LOAD COMMAND
70E1 00               2302  CKSM   DS     1        ;RECORD CHECKSUM USED IN 
                        LOAD COMMAND


Crasm 1.8:                           MONDEB                  page 45

                      2303  
                      2304  ;CONVENIENT EQUIVALENCES FOR LOCAL VARIABLES
  70B8                2305  MEMADR EQU    TEMP1    ;DISPLAY,SET,SEARCH,TEST
  70BA                2306  STRNUM EQU    TEMP2    ;FNDSTR
  70BB                2307  EOSCHR EQU    TEMP2+1  ;FNDSTR
                      2308  
                      2309  ;FOR "SEARCH" COMMAND
  70BA                2310  BYTPTR EQU    TEMP2
  70BC                2311  NBYTES EQU    TEMP3
  70BD                2312  NBRMAT EQU    TEMP3+1
  70BE                2313  BYTSTR EQU    TEMP4
                      2314  
                      2315  ;      END
                      2316  

ERRORS:       0
WARNINGS:     0

Successful assembly...
 Last address     70e1 (28897)
 Code length      19ae (6574)











































Crasm 1.8:                           MONDEB                  page 46

 7F43   Abs ACIA1                                            
 7F45   Abs ACIA2                                            
 F45A   Abs BADS1                                            
^F465   Abs BADS2                                            
 F457   Abs BADSYN                                           
 005C   Abs BAKSLA                                           
^F978   Abs BLDADR                                           
^700E   Abs BOLFLG                                           
^F558   Abs BREAK                                            
^F56D   Abs BREAK1                                           
^F57E   Abs BREAK2                                           
^F58E   Abs BREAK3                                           
^F5A6   Abs BREAK4                                           
^F5B2   Abs BREAK5                                           
^F5B5   Abs BREAK6                                           
^7020   Abs BRKADR                                           
^7022   Abs BRKINS                                           
^702C   Abs BUFBEG                                           
^702E   Abs BUFEND                                           
^70E0   Abs BYTECT                                           
^70BA   Abs BYTPTR                                           
^70BE   Abs BYTSTR                                           
^FC7B   Abs C100                                             
^FC77   Abs C10K                                             
^701F   Abs CHKSUM                                           
^70E1   Abs CKSM                                             
^F757   Abs CKSUM                                            
 F75C   Abs CKSUM1                                           
 F9E3   Abs CMD3                                             
 F9EC   Abs CMD4                                             
^7008   Abs COMADR                                           
^F9C7   Abs COMAND                                           
^FCD7   Abs COMLST                                           
^70D6   Abs COMNUM                                           
^F878   Abs COMPA1                                           
^F85C   Abs COMPAR                                           
^FBD9   Abs CONERR                                           
^F604   Abs CONTIN                                           
^F52C   Abs COPY                                             
 F539   Abs COPY1                                            
^F552   Abs COPY2                                            
^F555   Abs COPY3                                            
^702A   Abs CPLCNT                                           
^702B   Abs CPLMAX                                           
 000D   Abs CR                                               
^F5CE   Abs DBASE                                            
^F5D9   Abs DBASE1                                           
 F5DF   Abs DBASE2                                           
^F5EE   Abs DBASE3                                           
^F5F2   Abs DBASE4                                           
^7011   Abs DBCODE                                           
^7012   Abs DBNBR                                            
^F5EA   Abs DBTBL                                            
^70D9   Abs DECDIG                                           
^FB95   Abs DECNUM                                           
^F9B5   Abs DELAY                                            
 007F   Abs DELETE                                           
^700F   Abs DELIM                                            
^FAE9   Abs DIFNUM                                           
 FC28   Abs DISNU1                                           
^FC36   Abs DISNU2                                           
^FC92   Abs DISNU3                                           


Crasm 1.8:                           MONDEB                  page 47

 FCA2   Abs DISNU4                                           
^F670   Abs DISP10                                           
 F620   Abs DISPL1                                           
^F637   Abs DISPL2                                           
^F644   Abs DISPL3                                           
^F64D   Abs DISPL4                                           
^F64F   Abs DISPL5                                           
^F654   Abs DISPL6                                           
^F65F   Abs DISPL7                                           
^F662   Abs DISPL8                                           
^F66D   Abs DISPL9                                           
^F608   Abs DISPLA                                           
 F4C7   Abs DISREG                                           
^FAD3   Abs DLMNO                                            
^FAD0   Abs DLMYES                                           
 FED9   Abs DOCRL1                                           
^FEC7   Abs DOCRLF                                           
^F885   Abs DUMP                                             
 F88B   Abs DUMP1                                            
^F910   Abs DUMP10                                           
?F892   Abs DUMP2                                            
^F89A   Abs DUMP3                                            
^F8A5   Abs DUMP4                                            
^F8AD   Abs DUMP5                                            
 F8B5   Abs DUMP6                                            
^F8C7   Abs DUMP7                                            
^F8C9   Abs DUMP8                                            
 F8E9   Abs DUMP9                                            
^FDE9   Abs ECHO                                             
^FDF1   Abs ECHO1                                            
^70BB   Abs EOSCHR                                           
^FAD5   Abs ERROR                                            
 FA58   Abs FNDST1                                           
 FA5E   Abs FNDST2                                           
^FA68   Abs FNDST3                                           
^FA51   Abs FNDSTR                                           
^FCC0   Abs GETCHR                                           
^F44E   Abs GETCMD                                           
^FD9E   Abs GETIT                                            
^FD8C   Abs GETLIN                                           
^FCCD   Abs GETLST                                           
^F514   Abs GOTO                                             
^F521   Abs GOTO1                                            
^FB03   Abs GTRAN1                                           
^FB0B   Abs GTRAN2                                           
^FB18   Abs GTRAN3                                           
^FB20   Abs GTRAN4                                           
^FB26   Abs GTRAN5                                           
^FB27   Abs GTRAN6                                           
^FB2D   Abs GTRAN7                                           
^FB30   Abs GTRAN8                                           
^FAFC   Abs GTRANG                                           
^FBCD   Abs GUDNUM                                           
^7029   Abs HDXFLG                                           
^FB89   Abs HEXN1                                            
^FB7B   Abs HEXNUM                                           
^F5B8   Abs IBASE                                            
^F5C3   Abs IBASE1                                           
^F5C8   Abs IBASE2                                           
^7010   Abs IBCODE                                           
^F998   Abs INHEX                                            
^F9AD   Abs INHEX1                                           


Crasm 1.8:                           MONDEB                  page 48

^F9AE   Abs INHEX2                                           
^F9D1   Abs INILST                                           
^FE08   Abs INITAL                                           
^7024   Abs INPADR                                           
^FE66   Abs INPCH1                                           
^FE69   Abs INPCH2                                           
 FE6A   Abs INPCH3                                           
^FE59   Abs INPCHR                                           
^7023   Abs INPFLG                                           
^F844   Abs INT                                              
 FF99   Abs INTADR                                           
^7000   Abs INTVEC                                           
^FAA8   Abs ISDLM2                                           
^FAB2   Abs ISDLM3                                           
^FABC   Abs ISDLM4                                           
^F400   Abs JMP256                                           
^F476   Abs JMPCMD                                           
^00F4   Abs JMPHI                                            
^0085   Abs JMPLO                                            
 F485   Abs JMPTBL                                           
^7019   Abs LASTGO                                           
^FE02   Abs LASWAS                                           
^F529   Abs LCLI                                             
^FCB8   Abs LEFSHF                                           
 000A   Abs LF                                               
^700C   Abs LINPTR                                           
^70D5   Abs LISNUM                                           
^70D7   Abs LISPTR                                           
^F924   Abs LOAD                                             
 F936   Abs LOAD1                                            
^F955   Abs LOAD2                                            
^F961   Abs LOAD3                                            
^F972   Abs LOAD4                                            
^F526   Abs LSEI                                             
^FCB3   Abs LSH2                                             
^F854   Abs LSWI                                             
^FA07   Abs MATCH                                            
^70B8   Abs MEMADR                                           
^FA2B   Abs MFAIL                                            
^FF18   Abs MSGBAT                                           
^FF32   Abs MSGCCL                                           
^FF8B   Abs MSGCNH                                           
^FF3D   Abs MSGCSO                                           
^FF56   Abs MSGDIS                                           
^FEF2   Abs MSGHED                                           
^FF07   Abs MSGLTL                                           
^FF10   Abs MSGNBR                                           
^FF22   Abs MSGNVE                                           
^FEFF   Abs MSGPRM                                           
^FF60   Abs MSGS0                                            
^FF74   Abs MSGS1                                            
^FF7B   Abs MSGS9                                            
^FF4E   Abs MSGSIS                                           
^FF01   Abs MSGSWI                                           
^FF1F   Abs MSGVER                                           
^70DC   Abs NBR2X                                            
^7013   Abs NBRHI                                            
^7014   Abs NBRLO                                            
^70BD   Abs NBRMAT                                           
^70BC   Abs NBYTES                                           
^FA1B   Abs NEXCOM                                           
^FA11   Abs NMATCH                                           


Crasm 1.8:                           MONDEB                  page 49

^F84C   Abs NMI                                              
 FF9E   Abs NMIADR                                           
^7002   Abs NMIVEC                                           
 F46F   Abs NOMORE                                           
^FDCA   Abs NOTCTC                                           
^FDBF   Abs NOTEOL                                           
^F913   Abs NULLS                                            
 F916   Abs NULLS1                                           
^FB47   Abs NUMBER                                           
^70DA   Abs NUMBHI                                           
^70DB   Abs NUMBLO                                           
^FB43   Abs NUMIN1                                           
^FB3C   Abs NUMINX                                           
^FB60   Abs NUMLUP                                           
^70D4   Abs NUMMAT                                           
 FD90   Abs NXTCHR                                           
^FBBC   Abs OCTNUM                                           
^FBFD   Abs OUT1BY                                           
^F4E3   Abs OUT2                                             
^F4F2   Abs OUT2A4                                           
^FC04   Abs OUT2BY                                           
^F4EA   Abs OUT4                                             
^7027   Abs OUTADR                                           
^FDE2   Abs OUTBAK                                           
^FC9F   Abs OUTBIN                                           
 FE8A   Abs OUTCH1                                           
^FE92   Abs OUTCH2                                           
^FE98   Abs OUTCH3                                           
^FE9D   Abs OUTCH4                                           
^FEA3   Abs OUTCH5                                           
^FEAB   Abs OUTCH6                                           
^FEBE   Abs OUTCH7                                           
^FEC0   Abs OUTCH8                                           
^FE76   Abs OUTCHR                                           
^FC4B   Abs OUTDE1                                           
^FC52   Abs OUTDE2                                           
 FC55   Abs OUTDE3                                           
^FC60   Abs OUTDE4                                           
^FC72   Abs OUTDE5                                           
^FC3D   Abs OUTDEC                                           
^FE57   Abs OUTEND                                           
^FBF7   Abs OUTEQ                                            
^7026   Abs OUTFLG                                           
^FC27   Abs OUTHEX                                           
^FCAD   Abs OUTIT                                            
^FC0B   Abs OUTNUM                                           
^FC8D   Abs OUTOC1                                           
^FC81   Abs OUTOCT                                           
^F91D   Abs OUTP2                                            
^F87B   Abs OUTSD                                            
^FBF1   Abs OUTSP                                            
 FE4C   Abs OUTST1                                           
^FE4B   Abs OUTSTR                                           
^F434   Abs PROMP1                                           
 F425   Abs PROMPT                                           
^7017   Abs RANGHI                                           
^7015   Abs RANGLO                                           
^F986   Abs RDBYTE                                           
^F4C7   Abs REG                                              
 FFA3   Abs RESADR                                           
^FDF3   Abs RUBNOW                                           
^F7EA   Abs SEAR10                                           


Crasm 1.8:                           MONDEB                  page 50

 F774   Abs SEARC1                                           
^F793   Abs SEARC2                                           
 F79F   Abs SEARC3                                           
 F7AB   Abs SEARC4                                           
^F7B8   Abs SEARC5                                           
 F7BB   Abs SEARC6                                           
 F7CF   Abs SEARC7                                           
^F7DC   Abs SEARC8                                           
^F7E7   Abs SEARC9                                           
^F766   Abs SEARCH                                           
^F673   Abs SET                                              
 F68A   Abs SET1                                             
^F70E   Abs SET10                                            
^F71A   Abs SET11                                            
^F71D   Abs SET12                                            
^F694   Abs SET2                                             
 F697   Abs SET3                                             
^F6A9   Abs SET4                                             
^F6C6   Abs SET5                                             
^F6E4   Abs SET6                                             
^F6EC   Abs SET7                                             
^F6F4   Abs SET8                                             
^F701   Abs SET9                                             
^FBED   Abs SHFTER                                           
^FBE4   Abs SHIFT                                            
^FBDF   Abs SHIFT2                                           
 FA6F   Abs SKPDL1                                           
^FA7A   Abs SKPDL2                                           
^FA81   Abs SKPDL3                                           
^FA69   Abs SKPDLM                                           
^7006   Abs SP                                               
^70B1   Abs STACK                                            
 F400   Abs START                                            
^FDD8   Abs STORIT                                           
^70BA   Abs STRNUM                                           
^FAD6   Abs SUMNUM                                           
 FFA6   Abs SWIADR                                           
^7004   Abs SWIVEC                                           
^700A   Abs SYNPTR                                           
^70B8   Abs TEMP1                                            
?70CA   Abs TEMP10                                           
?70CC   Abs TEMP11                                           
 70BA   Abs TEMP2                                            
^70BC   Abs TEMP3                                            
^70BE   Abs TEMP4                                            
^70C0   Abs TEMP5                                            
?70C2   Abs TEMP6                                            
?70C4   Abs TEMP7                                            
?70C6   Abs TEMP8                                            
?70C8   Abs TEMP9                                            
^F7ED   Abs TEST                                             
 F7F8   Abs TEST1                                            
^F806   Abs TEST2                                            
^F813   Abs TEST3                                            
^F824   Abs TEST4                                            
^70DE   Abs TIMCON                                           
 F9C0   Abs TIMDE1                                           
^F9BD   Abs TIMDEL                                           
 FEE8   Abs TOACI1                                           
^FEE5   Abs TOACIA                                           
 FAAC   Abs TSTCMA                                           
^FDAB   Abs TSTCR                                            


Crasm 1.8:                           MONDEB                  page 51

^FDB3   Abs TSTCR1                                           
^FDBE   Abs TSTCR2                                           
^FA94   Abs TSTDLM                                           
^FA93   Abs TSTEO1                                           
^FA89   Abs TSTEOL                                           
^7030   Abs TTYBUF                                           
^7078   Abs TTYEND                                           
 FA40   Abs TYPCM1                                           
^FA4C   Abs TYPCM2                                           
^FA2E   Abs TYPCMD                                           
^F510   Abs TYPSW1                                           
 F501   Abs TYPSWI                                           
^701B   Abs VERFRM                                           
^F740   Abs VERIF1                                           
^F74F   Abs VERIF2                                           
^F720   Abs VERIFY                                           
^701D   Abs VERTO                                            
^70CE   Abs XTEMP                                            
^70D0   Abs XTEMP1                                           
^70D2   Abs XTEMP2                                           












































